

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Zs">
  <meta name="keywords" content="">
  
    <meta name="description" content="è¯¾ç¨‹ç½‘ç«™ï¼šhttps:&#x2F;&#x2F;cs61c.org&#x2F;su20&#x2F; B ç«™ https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1fC4y147iZ&#x2F;?vd_source&#x3D;518199b8942410d3723d3db827513479 https:&#x2F;&#x2F;www.youtube.com&#x2F;playlist?list&#x3D;PLDoI-XvXO0aqgoMQvogzmf7CKiSMSUS3M https">
<meta property="og:type" content="article">
<meta property="og:title" content="cs16c">
<meta property="og:url" content="http://shuaizhang1998.github.io/2023/11/03/CS61C/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="è¯¾ç¨‹ç½‘ç«™ï¼šhttps:&#x2F;&#x2F;cs61c.org&#x2F;su20&#x2F; B ç«™ https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1fC4y147iZ&#x2F;?vd_source&#x3D;518199b8942410d3723d3db827513479 https:&#x2F;&#x2F;www.youtube.com&#x2F;playlist?list&#x3D;PLDoI-XvXO0aqgoMQvogzmf7CKiSMSUS3M https">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-11-02T16:00:30.765Z">
<meta property="article:modified_time" content="2023-11-02T16:13:45.622Z">
<meta property="article:author" content="Zs">
<meta property="article:tag" content="ç¬”è®°">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>cs16c - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"shuaizhang1998.github.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="cs16c"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-03 00:00" pubdate>
          2023å¹´11æœˆ3æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          30k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          250 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">cs16c</h1>
            
            
              <div class="markdown-body">
                
                <ul>
<li>è¯¾ç¨‹ç½‘ç«™ï¼š<a
target="_blank" rel="noopener" href="https://cs61c.org/su20/">https://cs61c.org/su20/</a></li>
<li>B ç«™ <a
target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fC4y147iZ/?vd_source=518199b8942410d3723d3db827513479">https://www.bilibili.com/video/BV1fC4y147iZ/?vd_source=518199b8942410d3723d3db827513479</a></li>
<li><a
target="_blank" rel="noopener" href="https://www.youtube.com/playlist?list=PLDoI-XvXO0aqgoMQvogzmf7CKiSMSUS3M">https://www.youtube.com/playlist?list=PLDoI-XvXO0aqgoMQvogzmf7CKiSMSUS3M</a></li>
<li><a
target="_blank" rel="noopener" href="https://github.com/PKUFlyingPig/CS61C-summer20/tree/master/slides">https://github.com/PKUFlyingPig/CS61C-summer20/tree/master/slides</a></li>
</ul>
<h1 id="lecture-1---number-representation">Lecture 1 - Number
Representation</h1>
<ul>
<li><p>numbers representate everything</p>
<p>æ•°å­—å¯ä»¥è¡¨ç¤ºä»»ä½•ä¸œè¥¿ï¼Œåªéœ€è¦å¯¹å…¶èµ‹äºˆæ„ä¹‰ï¼Œä¾‹å¦‚å¯¹äº1-10æ¥è¯´</p>
<ul>
<li>å¯ä»¥ä»£è¡¨10ä¸ªæ­£æ•°</li>
<li>å¯ä»¥ä»£è¡¨10ä¸ªä¸åŒçš„ä¸œè¥¿</li>
<li>....</li>
</ul></li>
<li><p>ä¸ºä»€ä¹ˆä½¿ç”¨äºŒè¿›åˆ¶</p>
<ul>
<li>æ¶‰åŠåˆ°ç”µæ°”çš„ç‰¹æ€§ï¼Œ2è¿›åˆ¶ä¿¡å·å¯ä»¥ç®€å•çš„ç”¨é«˜ä½ç”µå¹³æ¥è¡¨ç¤ºï¼Œè¿™æä¾›äº†æ›´å¤§çš„å®¹é”™ç‡ï¼Œåœ¨ä¸€å®šçš„ç”µå‹åŒºé—´ä¸­ï¼Œè¿›åˆ¶è¶Šé«˜ï¼Œé”™è¯¯ç‡è¶Šé«˜ã€‚</li>
<li><span class="math inline">\(C_{10} = a[n-1] \cdot r^{n-1} + a[n-2]
\cdot r^{n-2} + \ldots + a[0] \cdot r^0\)</span> <span
class="math inline">\(r\)</span>ä»£è¡¨<span
class="math inline">\(r\)</span>è¿›åˆ¶</li>
<li><span class="math inline">\(1011 = 1*2^0+1*2^1+0+1*2^3\)</span></li>
</ul></li>
<li><p>æ€ä¹ˆè¡¨ç¤ºæœ‰ç¬¦å·æ•°</p>
<ul>
<li>Sign and Magnitude ï¼ˆç¬¦å·-å¹…åº¦ åŸç ï¼‰
<ul>
<li>æœ€é«˜ä½ä»£è¡¨ç¬¦å·ä½ï¼Œå…¶ä½™ä½ä»£è¡¨æ•°å€¼ï¼Œç¼ºç‚¹æ˜¯ï¼ˆåŒæ—¶å­˜åœ¨ä¸¤ç§0ï¼š<code>100</code>
= <code>000</code>)</li>
</ul></li>
<li>Biased Notation ï¼ˆåç½®æ³•ï¼‰
<ul>
<li>æ€æƒ³å°±æ˜¯å®šä¹‰åŸŸçš„ç§»åŠ¨ï¼Œé€‰å–æŸä¸ªæ­£åŒºé—´ä¸­çš„æŸä¸ªæ•°ä½œä¸º<code>0</code><br />
</li>
</ul></li>
<li>Oneâ€˜s Complement ï¼ˆ1è¡¥æ•° åç ï¼‰
<ul>
<li>åŒæ ·ä½¿å¾—æœ€é«˜ä½ä»£è¡¨ç¬¦å·ä½ï¼Œæœ€å¤§æ­£æ•°ä¸º<code>0111...111</code>,æœ€å°è´Ÿæ•°ä¸º<code>100...000</code>,åŒæ ·å­˜åœ¨ä¸¤ä¸ª<code>0</code>ï¼ˆ<code>000 = 111</code>ï¼‰ï¼Œæœ‰æº¢å‡ºé—®é¢˜(å¾ªç¯ç§»ä½ï¼‰</li>
</ul></li>
<li>Twoâ€˜s Complement <strong>ï¼ˆ2è¡¥æ•° è¡¥ç ï¼‰</strong>
<ul>
<li>ç°åœ¨éƒ½åœ¨ç”¨çš„ï¼Œå¤„ç†æº¢å‡ºé—®é¢˜æ¯”è¾ƒç®€å•ï¼ˆ<code>++ -&gt; -</code>
<code>-- -&gt; +</code> <code>+(-)- -&gt; -</code>
<code>-(-)+ -&gt;+</code>ï¼Œç°ä»£å¤„ç†å™¨æ£€æŸ¥æº¢å‡ºæ ‡å¿—ä½</li>
<li><code>111...111</code>ä¸åœ¨ä»£è¡¨<code>0</code>è€Œæ˜¯ä»£è¡¨<code>1</code></li>
</ul></li>
</ul></li>
<li><p>æœ‰ç¬¦å·æ•°çš„å¤„ç†</p>
<ul>
<li>Sign Extension å¾ˆå¤šæ“ä½œéœ€è¦ï¼Œä¾‹å¦‚ä¸åŒä½å®½æ•°æ®çš„è¿ç®—
<ul>
<li>æ­£æ•°æ·»åŠ å‰å¯¼0å³å¯ï¼Œè´Ÿæ•°åˆ™éœ€è¦å…ˆå¤åˆ¶ç¬¦å·ä½ï¼Œç„¶åå†å¤åˆ¶å…¶ä½™ä½ã€‚ç¬¦å·ä½å¤åˆ¶å¤šå°‘æ¬¡å–å†³äºæ–°çš„ä½å®½ï¼Œä¾‹å¦‚ä»8ä½åˆ°16ä½ï¼Œåˆ™éœ€è¦æŠŠç¬¦å·ä½å¤åˆ¶8æ¬¡ã€‚</li>
</ul></li>
</ul></li>
<li><p>è½¬æ¢è§„åˆ™æ¨è</p>
<ul>
<li><code>Ki=1024</code> ï¼Œè€Œ<code>K=1000</code>
ã€‚<code>B</code>æ˜¯å­—èŠ‚ï¼ˆByteï¼‰ ï¼Œè€Œ<code>b</code>æ˜¯äºŒè¿›åˆ¶ä½</li>
</ul></li>
<li><p>åŸç ï¼Œåç ï¼Œè¡¥ç  ç”¨è¡¥ç è¿ç®—ï¼Œç”¨åŸç çœ‹ç»“æœ</p>
<ul>
<li>0ä¸‰ç éƒ½ä¸º0</li>
<li>æ­£æ•°ä¸‰ç ç›¸ç­‰</li>
<li>è´Ÿæ•°åç æ˜¯åŸç ç¬¦å·ä½ä»¥å¤–å…¨éƒ¨å–åï¼Œè¡¥ç åœ¨åç åŸºç¡€ä¸ŠåŠ 1</li>
</ul></li>
</ul>
<h1 id="lecture-2-intro-with-c">Lecture 2 Intro with c</h1>
<ul>
<li>å­¦å®Œ<code>Introductory C Programming Specialization</code>å³å¯</li>
</ul>
<h1 id="lecture-3-intro-with-array">Lecture 3 Intro with array</h1>
<ul>
<li><p>å­¦å®Œ<code>Introductory C Programming Specialization</code>å³å¯ #
Lecture 4 Memory Management and Usage</p></li>
<li><p>å­¦å®Œ<code>Introductory C Programming Specialization</code>å³å¯</p></li>
</ul>
<h1 id="lecture-5-floating-representation">Lecture 5 floating
representation</h1>
<ul>
<li>åè¿›åˆ¶oräºŒè¿›åˆ¶<code>**ç‚¹åˆ†æ³•**</code>ç†è®ºä¸Šå¯ä»¥è¡¨ç¤ºæ— ç©·çš„ç²¾åº¦
<ul>
<li>ä¾‹å¦‚<span class="math inline">\(\frac{1}{3} =
0.333.....\)</span></li>
<li>ä¾‹å¦‚<span class="math inline">\(\frac{1}{10} =
0.0001100011...\)</span></li>
<li>ä¸ºä»€ä¹ˆä¼šå‡ºç°æ— é™å¾ªç¯å°æ•°</li>
</ul></li>
</ul>
<hr />
<p><strong>å®šç†</strong>ï¼šè€ƒè™‘ä¸€ä¸ªåˆ†æ•°<span
class="math inline">\(\frac{a}{b} ï¼ˆå…¶ä¸­b \neq 0 )\)</span>ï¼Œè‹¥å…¶åœ¨<span
class="math inline">\(N\)</span>è¿›åˆ¶ä¸‹è¡¨ç¤ºä¸ºæœ‰é™å°æ•°ï¼Œåˆ™åˆ†æ¯<span
class="math inline">\(b\)</span>çš„æ‰€æœ‰è´¨å› å­å¿…é¡»æ˜¯è¿›åˆ¶æ•°<span
class="math inline">\(N\)</span>çš„è´¨å› å­ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<ol type="1">
<li>è®¾<span class="math inline">\(N\)</span>çš„è´¨å› å­åˆ†è§£ä¸ºï¼š<span
class="math inline">\(N = p_1^{k_1} p_2^{k_2} \dots
p_m^{k_m}\)</span>ï¼Œå…¶ä¸­ï¼Œ<span class="math inline">\(p_1, p_2, \dots,
p_m\)</span>æ˜¯è´¨æ•°ï¼Œä¸”<span class="math inline">\(k_1, k_2, \dots,
k_m\)</span>æ˜¯æ­£æ•´æ•°ã€‚</li>
<li>è‹¥<span class="math inline">\(\frac{a}{b}\)</span>åœ¨<span
class="math inline">\(N\)</span>è¿›åˆ¶ä¸‹æ˜¯æœ‰é™å°æ•°ï¼Œåˆ™å­˜åœ¨æŸä¸ªæ­£æ•´æ•°<span
class="math inline">\(s\)</span>ä½¿å¾—<span class="math inline">\(b \times
N^s\)</span>æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚è¿™æ„å‘³ç€ï¼š</li>
</ol>
<p><span class="math inline">\(b \times N^s = b \times p_1^{k_1 s}
p_2^{k_2 s} \dots p_m^{k_m s}\)</span>æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚</p>
<ol start="3" type="1">
<li>ç°åœ¨è€ƒè™‘<span class="math inline">\(b\)</span>çš„è´¨å› å­åˆ†è§£ã€‚è‹¥<span
class="math inline">\(b\)</span>æœ‰ä¸€ä¸ªè´¨å› å­<span
class="math inline">\(q\)</span>ä¸æ˜¯<span
class="math inline">\(N\)</span>çš„è´¨å› å­ï¼ˆ å³<span
class="math inline">\(q\)</span>ä¸ç­‰äºä»»ä½•çš„<span
class="math inline">\(p_i\)</span>ï¼‰ï¼Œåˆ™å¯¹äºä»»ä½•æ­£æ•´æ•°<span
class="math inline">\(s\)</span>ï¼Œä¹˜ç§¯<span class="math inline">\(b
\times N^s\)</span>éƒ½ä¸å¯èƒ½æ˜¯æ•´æ•°ï¼Œå› ä¸ºæ— æ³•æ¶ˆé™¤è¿™ä¸ªâ€œå¤–éƒ¨â€è´¨å› å­<span
class="math inline">\(q\)</span>ã€‚</li>
</ol>
<hr />
<ul>
<li>äºŒè¿›åˆ¶ç‚¹åˆ†æ³•ä¸­çš„ç‚¹çš„ä½ç½®ä¸ç¡®å®š(å¤šå°‘ä½è¡¨ç¤ºæ•´æ•°ï¼Œå¤šå°‘ä½è¡¨ç¤ºå°æ•°)ï¼Œæ‰€ä»¥å¼•å…¥<code>äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•</code>
<ul>
<li>ä¼˜ç‚¹
<ul>
<li>ç›¸å¯¹äºäºŒè¿›åˆ¶ç‚¹åˆ†æ³•
è¡¨ç¤ºçš„èŒƒå›´èƒ½å¤Ÿå¾ˆè½»æ¾çš„é€šè¿‡è°ƒæ•´æŒ‡æ•°å’Œå°¾æ•°æ¥<strong>æ‰©å¤§æˆ–å‡å°æ•°çš„èŒƒå›´</strong></li>
</ul></li>
<li>ç¼ºç‚¹
<ul>
<li>å®é™…è®¡ç®—çš„èˆå…¥è¯¯å·® ï¼ˆå°¾æ•°ä½æœ‰é™å¯¼è‡´ï¼‰</li>
<li>ä¸ç²¾ç¡®çš„è¡¨ç¤º ï¼ˆå°¾æ•°ä½æœ‰é™å¯¼è‡´ï¼‰</li>
</ul></li>
</ul></li>
</ul>
<hr />
<p>ç»™å®šä¸€ä¸ªéé›¶å®æ•° <span
class="math inline">\(x\)</span>ï¼Œåœ¨äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•ä¸­ï¼Œ<span
class="math inline">\(x\)</span> å¯ä»¥è¡¨ç¤ºä¸ºï¼š <span
class="math inline">\(x = (-1)^s \times 1.f_1 f_2 f_3 \ldots \times
2^e\)</span> å…¶ä¸­ï¼š</p>
<ol type="1">
<li><span class="math inline">\(s\)</span> æ˜¯ç¬¦å·ä½ï¼Œå½“ <span
class="math inline">\(x\)</span> ä¸ºæ­£æ•°æ—¶ <span class="math inline">\(s
= 0\)</span>ï¼Œå½“ <span class="math inline">\(x\)</span> ä¸ºè´Ÿæ•°æ—¶ <span
class="math inline">\(s = 1\)</span>ã€‚</li>
<li><span class="math inline">\(1.f_1 f_2 f_3 \ldots\)</span>
æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å°æ•°ï¼ˆ<code>å°¾æ•°</code>ï¼‰ï¼Œå…¶ä¸­ <span
class="math inline">\(f_i\)</span> æ˜¯ä½äºå°æ•°ç‚¹åçš„ç¬¬ <span
class="math inline">\(i\)</span> ä½çš„æ•°å­—ï¼Œæ¯ä¸ª <span
class="math inline">\(f_i\)</span> è¦ä¹ˆä¸º <span
class="math inline">\(0\)</span> è¦ä¹ˆä¸º <span
class="math inline">\(1\)</span>ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬é»˜è®¤å°æ•°ç‚¹å‰æœ‰ä¸€ä¸ª<span
class="math inline">\(1\)</span>ï¼Œè¿™æ˜¯å› ä¸ºåœ¨äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•çš„è§„èŒƒåŒ–è¡¨ç¤ºä¸­ï¼Œéé›¶æ•°çš„æœ€é«˜æœ‰æ•ˆä½<strong>æ€»æ˜¯1ã€‚</strong></li>
<li><span class="math inline">\(e\)</span>
æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ˆ<code>æŒ‡æ•°</code>ï¼‰ï¼Œä»£è¡¨äºŒè¿›åˆ¶æŒ‡æ•°ã€‚</li>
</ol>
<p>ä¾‹å¦‚ï¼Œæ•°å­— <span class="math inline">\(13\)</span> åœ¨äºŒè¿›åˆ¶ä¸­è¡¨ç¤ºä¸º
<span class="math inline">\(1101\)</span>ï¼Œå…¶äºŒè¿›åˆ¶ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºä¸º
<span class="math inline">\(1.101 \times 2^3\)</span>ã€‚ åœ¨è®¡ç®—æœºçš„IEEE
754æµ®ç‚¹æ•°è¡¨ç¤ºæ³•ä¸­ï¼Œå› ä¸ºæœ€é«˜æœ‰æ•ˆä½æ€»æ˜¯1ï¼Œæ‰€ä»¥é€šå¸¸ä¼šçœç•¥å®ƒä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚è¿™æ˜¯æ‰€è°“çš„"éšè—ä½"æŠ€æœ¯ã€‚</p>
<hr />
<ul>
<li>IEEE754æ˜¯ç›®å‰å¸¸ç”¨çš„æ ‡å‡†</li>
</ul>
<p><code>ç¬¦å·ä½ï¼ˆ1ä½ï¼‰``æŒ‡æ•°ä½ï¼ˆé˜¶ç  8ä½æ— ç¬¦å·æ•°ï¼‰``å°¾æ•°ä½ï¼ˆå°æ•°ä½ 23ä½ï¼‰</code>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">annotated_ieee754_conversion</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Convert a floating-point number to its IEEE 754 single-precision representation.</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    Parameters:</span><br><span class="hljs-string">    - num: Floating-point number to be converted</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">    - Tuple containing (sign_bit, exponent_binary, fraction_bits)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <br>    <span class="hljs-comment"># Step 1: Determine the sign bit</span><br>    <span class="hljs-comment"># If the number is positive or zero, sign bit is 0. Otherwise, it&#x27;s 1.</span><br>    sign_bit = <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> num &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1</span><br>    <br>    <span class="hljs-comment"># Convert the number to positive for further processing.</span><br>    num = <span class="hljs-built_in">abs</span>(num)<br><br>    <span class="hljs-comment"># Step 2: Convert the number to binary representation.</span><br>    <span class="hljs-comment"># Convert the integer part of the number to binary.</span><br>    int_part = <span class="hljs-built_in">int</span>(num)<br>    int_binary = <span class="hljs-built_in">bin</span>(int_part)[<span class="hljs-number">2</span>:]<br>    <br>    <span class="hljs-comment"># Convert the fractional part of the number to binary.</span><br>    frac_num = num - int_part<br>    frac_binary = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(frac_binary) &lt; <span class="hljs-number">40</span> <span class="hljs-keyword">and</span> frac_num != <span class="hljs-number">0</span>:  <span class="hljs-comment"># Limit to 40 bits for precision.</span><br>        frac_num *= <span class="hljs-number">2</span><br>        frac_bit = <span class="hljs-built_in">int</span>(frac_num)<br>        frac_binary += <span class="hljs-built_in">str</span>(frac_bit)<br>        frac_num -= frac_bit<br><br>    <span class="hljs-comment"># Combine the integer and fractional parts.</span><br>    combined_binary = int_binary + frac_binary<br>    <br>    <span class="hljs-comment"># Step 3: Normalize the binary representation.</span><br>    normalized_position = combined_binary.index(<span class="hljs-string">&#x27;1&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Calculate the number of shifts required to normalize the number.</span><br>    shift = <span class="hljs-built_in">len</span>(int_binary) - <span class="hljs-number">1</span> - normalized_position <br>    <br>    <span class="hljs-comment"># Step 4: Calculate the biased exponent.</span><br>    <span class="hljs-comment"># IEEE 754 single-precision format uses a bias of 127.</span><br>    exponent_with_bias = shift + <span class="hljs-number">127</span><br>    exponent_binary = <span class="hljs-built_in">bin</span>(exponent_with_bias)[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;0&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Step 5: Determine the fraction part with rounding.</span><br>    fraction_24_bits = combined_binary[normalized_position+<span class="hljs-number">1</span>:normalized_position+<span class="hljs-number">25</span>].ljust(<span class="hljs-number">24</span>, <span class="hljs-string">&#x27;0&#x27;</span>) <span class="hljs-comment"># Ensure length</span><br><br>    <span class="hljs-comment"># Implement the &quot;round to nearest, ties to even&quot; strategy.</span><br>    <span class="hljs-keyword">if</span> fraction_24_bits[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">in</span> fraction_24_bits[<span class="hljs-number">1</span>:] <span class="hljs-keyword">or</span> fraction_24_bits[-<span class="hljs-number">2</span>] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            fraction_bits = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(fraction_24_bits[:-<span class="hljs-number">1</span>], <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>)[<span class="hljs-number">2</span>:].rjust(<span class="hljs-number">23</span>, <span class="hljs-string">&#x27;0&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            fraction_bits = fraction_24_bits[:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">else</span>:<br>        fraction_bits = fraction_24_bits[:-<span class="hljs-number">1</span>]<br><br>    <span class="hljs-keyword">return</span> (sign_bit, exponent_binary, fraction_bits)<br><br><span class="hljs-comment"># The testing part remains the same as before.</span><br>consistent = <span class="hljs-literal">True</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>    random_num = random.uniform(-<span class="hljs-number">1e6</span>, <span class="hljs-number">1e6</span>)<br>    single_precision_num = <span class="hljs-built_in">float</span>(random_num)<br>    manual_ieee754 = annotated_ieee754_conversion(single_precision_num)<br>    <br>    binary_representation = <span class="hljs-built_in">format</span>(struct.unpack(<span class="hljs-string">&#x27;!I&#x27;</span>, struct.pack(<span class="hljs-string">&#x27;!f&#x27;</span>, single_precision_num))[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;032b&#x27;</span>)<br>    builtin_sign_bit = <span class="hljs-built_in">int</span>(binary_representation[<span class="hljs-number">0</span>])<br>    builtin_exponent = binary_representation[<span class="hljs-number">1</span>:<span class="hljs-number">9</span>]<br>    builtin_fraction = binary_representation[<span class="hljs-number">9</span>:]<br>    builtin_ieee754 = (builtin_sign_bit, builtin_exponent, builtin_fraction)<br>    <br>    <span class="hljs-keyword">if</span> manual_ieee754 != builtin_ieee754:<br>        consistent = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">break</span><br><br>consistent<br><br></code></pre></td></tr></table></figure></p>
<ul>
<li>æµ®ç‚¹æ•°å­˜åœ¨ç²¾åº¦é—®é¢˜</li>
</ul>
<p><strong>åŸºæœ¬æ¦‚å¿µ</strong>: IEEE 754
æµ®ç‚¹æ•°ä½¿ç”¨å›ºå®šæ•°é‡çš„ä½æ¥è¡¨ç¤ºå®æ•°ã€‚ç”±äºå®æ•°èŒƒå›´æ˜¯æ— é™çš„ï¼Œè€Œæˆ‘ä»¬çš„è¡¨ç¤ºä½æ•°æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥å¿…ç„¶ä¼šæœ‰ç²¾åº¦æŸå¤±ã€‚
<strong>å…·ä½“é—®é¢˜</strong>ï¼š</p>
<ol type="1">
<li><strong>éè§„èŒƒåŒ–æ•°ä¸è§„èŒƒåŒ–æ•°</strong>:
å½“æ•°å€¼éå¸¸æ¥è¿‘äº0ï¼Œæˆ‘ä»¬ä½¿ç”¨éè§„èŒƒåŒ–æ•°æ¥è¡¨ç¤ºã€‚è¿™æ„å‘³ç€æˆ‘ä»¬æ”¾å¼ƒäº†ä¸€ä¸ªéšå«çš„å‰å¯¼1ï¼Œä»¥è·å¾—æ›´å¤šçš„å°æ•°ç‚¹åçš„ä½æ•°ï¼Œä½†è¿™é™ä½äº†ç²¾åº¦ã€‚</li>
<li>è€ƒè™‘ä¸€ä¸ªéå¸¸å°çš„æ•°ï¼Œå¦‚ <span class="math inline">\(1.0 \times
10^{-45}\)</span> åœ¨ IEEE 754
å•ç²¾åº¦æ ¼å¼ä¸­ï¼Œè¿™ä¸ªæ•°æ˜¯ä¸€ä¸ªéè§„èŒƒåŒ–æ•°ï¼Œå› ä¸ºå®ƒå¤ªå°äº†ï¼Œæ— æ³•ç”¨è§„èŒƒåŒ–æ•°è¡¨ç¤ºã€‚</li>
<li><strong>èˆå…¥é”™è¯¯</strong>:
ç”±äºè¡¨ç¤ºä½æ•°çš„é™åˆ¶ï¼Œå½“æˆ‘ä»¬å°è¯•è¡¨ç¤ºæŸäº›æ•°å€¼æ—¶ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œèˆå…¥ã€‚è¿™å¯¼è‡´äº†æ‰€è°“çš„èˆå…¥é”™è¯¯ã€‚</li>
<li>è€ƒè™‘æ•°å­— <span
class="math inline">\(0.1\)</span>ã€‚åœ¨äºŒè¿›åˆ¶ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— é™é‡å¤çš„å°æ•°ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬å°è¯•å°†å…¶è¡¨ç¤ºä¸º
IEEE 754 æµ®ç‚¹æ•°æ—¶ï¼Œå®ƒå¿…é¡»è¢«èˆå…¥ï¼Œå¯¼è‡´ç²¾åº¦æŸå¤±ã€‚</li>
<li><strong>è®¡ç®—ä¸­çš„ç´¯ç§¯è¯¯å·®</strong>:
åœ¨è¿›è¡Œæµ®ç‚¹è¿ç®—æ—¶ï¼ˆå¦‚åŠ æ³•ã€ä¹˜æ³•ç­‰ï¼‰ï¼Œè¯¯å·®å¯èƒ½ä¼šç´¯ç§¯ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿­ä»£è®¡ç®—ä¸­ã€‚</li>
<li>è€ƒè™‘ä¸€ä¸ªç®€å•çš„æ“ä½œï¼šå°† <span class="math inline">\(0.1\)</span> åŠ ä¸Š
<span class="math inline">\(0.2\)</span>ã€‚ç†è®ºä¸Šï¼Œç»“æœåº”è¯¥æ˜¯ <span
class="math inline">\(0.3\)</span>ï¼Œä½†ç”±äºèˆå…¥è¯¯å·®ï¼Œå®é™…çš„æµ®ç‚¹è®¡ç®—ç»“æœå¯èƒ½ä¼šç•¥æœ‰ä¸åŒã€‚</li>
<li><strong>æµ®ç‚¹æ•°ç›¸ç­‰æ€§</strong>:
ç”±äºç²¾åº¦é—®é¢˜ï¼Œç›´æ¥æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰é€šå¸¸æ˜¯ä¸å®‰å…¨çš„ã€‚ä¾‹å¦‚ï¼Œè®¡ç®—çš„ç»“æœ(0.3
+ 0.3 + 0.3)å¯èƒ½ä¸ç­‰äº(0.9)ï¼Œå°½ç®¡å·®å¼‚å¾ˆå°ã€‚</li>
<li>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¨‹åºï¼Œå®ƒè®¡ç®— <span class="math inline">\(0.3 - 0.2 -
0.1\)</span>ã€‚ç†è®ºä¸Šï¼Œç»“æœåº”è¯¥æ˜¯ <span
class="math inline">\(0\)</span>ï¼Œä½†ç”±äºèˆå…¥è¯¯å·®ï¼Œå®é™…çš„æµ®ç‚¹ç»“æœå¯èƒ½éå¸¸æ¥è¿‘äºé›¶ï¼Œä½†ä¸å®Œå…¨æ˜¯é›¶ã€‚</li>
<li><strong>æ¶ˆå¤±çš„å°¾æ•°ä½</strong>:
å½“å·®å¼‚å¾ˆå¤§çš„ä¸¤ä¸ªæ•°ç›¸åŠ æ—¶ï¼Œå°çš„æ•°å¯èƒ½åœ¨ç»“æœä¸­"æ¶ˆå¤±"ï¼Œå› ä¸ºå®ƒå¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ®å¤ªå°ï¼Œä¸èƒ½åœ¨æœ‰é™çš„å°¾æ•°ä½ä¸­è¡¨ç¤ºã€‚</li>
<li>è€ƒè™‘ä¸¤ä¸ªæ•°ï¼š<span class="math inline">\(10^9 + 1\)</span> å’Œ <span
class="math inline">\(10^9\)</span>ã€‚å½“å®ƒä»¬ç›¸å‡æ—¶ï¼Œç†è®ºä¸Šçš„ç»“æœæ˜¯ <span
class="math inline">\(1\)</span>ï¼Œä½†åœ¨æµ®ç‚¹è®¡ç®—ä¸­ï¼Œç»“æœå¯èƒ½æ˜¯ <span
class="math inline">\(0\)</span>ï¼Œå› ä¸ºå°çš„æ•°åœ¨å·®å¼‚å¾ˆå¤§çš„æ•°çš„è®¡ç®—ä¸­å¯èƒ½ä¼šâ€œæ¶ˆå¤±â€ã€‚</li>
</ol>
<ul>
<li>æµ®ç‚¹æ•°ç­‰é—´éš”ä¸­èƒ½è¡¨ç¤ºçš„æ•°çš„æ•°é‡ï¼Œéšç€æ•°çš„å¤§å°çš„å¢åŠ è€Œå‡å°‘</li>
</ul>
<p><strong>åŸºæœ¬æ¦‚å¿µ</strong>:
æµ®ç‚¹æ•°ç”±ç¬¦å·ã€æŒ‡æ•°å’Œå°¾æ•°ä¸‰éƒ¨åˆ†ç»„æˆã€‚æŒ‡æ•°éƒ¨åˆ†å†³å®šäº†æ•°çš„èŒƒå›´æˆ–å¤§å°ï¼Œè€Œå°¾æ•°éƒ¨åˆ†å†³å®šäº†æ•°çš„ç²¾åº¦ã€‚</p>
<ol type="1">
<li><strong>å›ºå®šå®½åº¦çš„å°¾æ•°</strong>ï¼šå°¾æ•°çš„å®½åº¦æ˜¯å›ºå®šçš„ï¼Œä¾‹å¦‚ï¼Œå¯¹äº IEEE
754
å•ç²¾åº¦ï¼Œå°¾æ•°æœ‰23ä½ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨ç»™å®šçš„æŒ‡æ•°å€¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¡¨ç¤ºçš„æ•°çš„æ•°é‡æ˜¯å›ºå®šçš„ã€‚</li>
<li>è€ƒè™‘æ•°å­— <span
class="math inline">\(1.23456789\)</span>ã€‚å°½ç®¡è¿™ä¸ªæ•°å­—åœ¨åè¿›åˆ¶ä¸­å¾ˆç®€å•ï¼Œä½†åœ¨å›ºå®šå®½åº¦çš„äºŒè¿›åˆ¶æµ®ç‚¹è¡¨ç¤ºä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æ— æ³•å‡†ç¡®åœ°è¡¨ç¤ºå®ƒã€‚</li>
<li><strong>ç­‰é—´éš”è¡¨ç¤º</strong>:
å¯¹äºç»™å®šçš„æŒ‡æ•°å€¼ï¼Œå°¾æ•°çš„æ¯ä¸€ä¸ªä½çš„å¢åŠ éƒ½è¡¨ç¤ºäº†ä¸€ä¸ªç­‰é—´éš”çš„å¢é‡ã€‚ä½†æ˜¯ï¼Œå½“æŒ‡æ•°å€¼å¢åŠ æ—¶ï¼Œè¿™ä¸ªé—´éš”ä¼šå˜å¾—æ›´å¤§ã€‚å› æ­¤ï¼Œå¯¹äºè¾ƒå¤§çš„æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¡¨ç¤ºçš„æ•°ä¹‹é—´çš„é—´éš”ä¼šå˜å¾—æ›´å¤§ã€‚</li>
<li>è€ƒè™‘ä¸¤ä¸ªç›¸é‚»çš„ IEEE 754
å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå…·æœ‰æœ€å¤§çš„æ­£æŒ‡æ•°å’Œå…¨é›¶çš„å°¾æ•°ï¼Œè€Œå¦ä¸€ä¸ªå…·æœ‰æœ€å¤§çš„æ­£æŒ‡æ•°ä½†å°¾æ•°å¢åŠ äº†æœ€å°çš„é‡ï¼ˆå³å°¾æ•°çš„æœ€åä¸€ä½æ˜¯1ï¼‰ã€‚è¿™ä¸¤ä¸ªæ•°ä¹‹é—´çš„å·®å¼‚å°†æ˜¯å·¨å¤§çš„ã€‚</li>
<li><strong>è¡¨ç¤ºèŒƒå›´ä¸é—´éš”çš„æƒè¡¡</strong>:
ç”±äºå°¾æ•°å®½åº¦çš„é™åˆ¶ï¼Œå½“æˆ‘ä»¬è¡¨ç¤ºæ›´å¤§çš„æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¡¨ç¤ºçš„æ•°çš„é—´éš”å¿…ç„¶å¢åŠ ã€‚è¿™æ„å‘³ç€ï¼Œå°½ç®¡æˆ‘ä»¬ä»ç„¶å¯ä»¥è¡¨ç¤ºå¤§èŒƒå›´å†…çš„æ•°ï¼Œä½†è¿™äº›æ•°ä¹‹é—´çš„é—´éš”ä¼šå˜å¾—æ›´å¤§ï¼Œä»è€Œå¯¼è‡´ç²¾åº¦æŸå¤±ã€‚</li>
<li>è€ƒè™‘æ•°å­— <span class="math inline">\(10^{30}\)</span> å’Œ <span
class="math inline">\(10^{30} +
10^{15}\)</span>ã€‚åœ¨å•ç²¾åº¦æµ®ç‚¹æ•°ä¸­ï¼Œè¿™ä¸¤ä¸ªæ•°å­—å¯èƒ½ä¼šæ˜ å°„åˆ°ç›¸åŒçš„å€¼ï¼Œå› ä¸ºå°¾æ•°çš„å®½åº¦é™åˆ¶äº†æˆ‘ä»¬èƒ½å¤ŸåŒºåˆ†çš„æ•°çš„æ•°é‡ã€‚è¿™æ˜¾ç¤ºäº†éšç€æ•°çš„å¢å¤§ï¼Œæˆ‘ä»¬å¤±å»äº†åŒºåˆ†ç›¸å¯¹è¾ƒå°å·®å¼‚çš„èƒ½åŠ›ã€‚</li>
</ol>
<h1 id="lecture-6-assembly">Lecture 6 Assembly</h1>
<h2 id="lec06.pdfx86"><a
target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2023/pdf/22918222/1698299457180-6a6c42fb-f3b9-40bb-9384-5f41bd85ecce.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2023%2Fpdf%2F22918222%2F1698299457180-6a6c42fb-f3b9-40bb-9384-5f41bd85ecce.pdf%22%2C%22name%22%3A%22lec06.pdf%22%2C%22size%22%3A8497764%2C%22ext%22%3A%22pdf%22%2C%22source%22%3A%22%22%2C%22status%22%3A%22done%22%2C%22download%22%3Atrue%2C%22taskId%22%3A%22uf1db4eaf-271c-485e-a482-07a2dc2187d%22%2C%22taskType%22%3A%22upload%22%2C%22type%22%3A%22application%2Fpdf%22%2C%22__spacing%22%3A%22both%22%2C%22mode%22%3A%22title%22%2C%22id%22%3A%22u6c61a067%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22file%22%7D">lec06.pdf</a>x86</h2>
<ul>
<li><strong>Designer</strong>: Intel, AMD</li>
<li><strong>Bits</strong>: 16-bit, 32-bit and 64-bit</li>
<li><strong>Introduced</strong>:
<ul>
<li>1978 (16-bit)</li>
<li>1985 (32-bit)</li>
<li>2003 (64-bit)</li>
</ul></li>
<li><strong>Design</strong>: CISC</li>
<li><strong>Type</strong>: Register-memory</li>
<li><strong>Encoding</strong>: Variable (1 to 15 bytes)</li>
<li><strong>Endianness</strong>: Little</li>
<li><strong>Usage</strong>: Macbooks &amp; PCs (Core i3, i5, i7, M)</li>
</ul>
<hr />
<h2 id="arm-architectures">ARM architectures</h2>
<ul>
<li><strong>Designer</strong>: ARM Holdings</li>
<li><strong>Bits</strong>: 32-bit, 64-bit</li>
<li><strong>Introduced</strong>: 1985; 31 years ago</li>
<li><strong>Design</strong>: RISC</li>
<li><strong>Type</strong>: Register-Register</li>
<li><strong>Encoding</strong>:
<ul>
<li>AArch64/A64 and AArch32/A32 use 32-bit instructions</li>
<li>T32 (Thumb-2) uses mixed 16- and 32-bit instructions. ARMv7
user-space compatibility</li>
</ul></li>
<li><strong>Endianness</strong>: Bi (little as default)</li>
<li><strong>Usage</strong>: Smartphone-like devices (iPhone, Android),
Raspberry Pi, Embedded systems</li>
</ul>
<hr />
<h2 id="risc-v">RISC-V</h2>
<ul>
<li><p><strong>Designer</strong>: University of California,
Berkeley</p></li>
<li><p><strong>Bits</strong>: 32, 64, 128</p></li>
<li><p><strong>Introduced</strong>: 2010</p></li>
<li><p><strong>Version</strong>: 2.2</p></li>
<li><p><strong>Design</strong>: RISC</p></li>
<li><p><strong>Type</strong>: Load-store</p></li>
<li><p><strong>Encoding</strong>: Variable</p></li>
<li><p><strong>Branching</strong>: Compare-and-branch</p></li>
<li><p><strong>Endianness</strong>: Little</p></li>
<li><p><strong>Usage</strong>: Versatile and open-source. Relatively
new, designed for cloud computing, embedded systems, academic
use</p></li>
<li><p>æ—©æœŸæŒ‡ä»¤é›†è®¾è®¡æ–¹å‘</p>
<ul>
<li>å¤æ‚æŒ‡ä»¤é›†ï¼ˆä¸æ–­ç»†åŒ–æŒ‡ä»¤ï¼‰ -&gt;
(éš¾å­¦ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¯ä»¥åšæ›´å°‘çš„äº‹ï¼Œæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºä¸»è¦æ˜¯è®¾è®¡æ›´å¤šçš„æŒ‡ä»¤ï¼‰
x86æ˜¯å…¸å‹ <code>CISC</code></li>
<li>ç²¾ç®€æŒ‡ä»¤é›† -&gt;ï¼ˆå¥½å­¦ï¼Œå¤æ‚çš„æŒ‡ä»¤é€šè¿‡ç®€å•æŒ‡ä»¤çš„ç»„åˆæ¥å®ç° å¿«ï¼‰
<code>RISC</code></li>
</ul></li>
</ul>
<p><a
target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2023/pdf/22918222/1698299998791-135851ce-b583-4d5c-b382-7bf7e3c71a5c.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2023%2Fpdf%2F22918222%2F1698299998791-135851ce-b583-4d5c-b382-7bf7e3c71a5c.pdf%22%2C%22name%22%3A%22RISV-2016-1.pdf%22%2C%22size%22%3A959927%2C%22ext%22%3A%22pdf%22%2C%22source%22%3A%22%22%2C%22status%22%3A%22done%22%2C%22download%22%3Atrue%2C%22taskId%22%3A%22uf7cc602f-2fe1-4ca7-af70-0e13efc8ca0%22%2C%22taskType%22%3A%22upload%22%2C%22type%22%3A%22application%2Fpdf%22%2C%22__spacing%22%3A%22both%22%2C%22mode%22%3A%22title%22%2C%22id%22%3A%22udd5c5e7a%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22file%22%7D">RISV-2016-1.pdf</a></p>
<h2 id="registers">Registers</h2>
<ul>
<li><p>æ±‡ç¼–æ²¡æœ‰å˜é‡çš„æ¦‚å¿µï¼Œåªæœ‰å¯„å­˜å™¨</p></li>
<li><p>ä¸åŒçš„ç¡¬ä»¶å¯èƒ½å¯„å­˜å™¨æ•°é‡/ä½æ•°ä¸åŒ</p></li>
<li><p>å¯ä»¥è¯»ï¼Œå†™ï¼›è€—ç”µé‡ç›¸è¾ƒäºMemoryå¾ˆå°‘ï¼›æ€§èƒ½å¿«</p></li>
<li><p>å¯„å­˜å™¨æ˜¯åœ¨CPUä¸Šçš„ç›´æ¥ç»“æ„</p></li>
<li><p>æ—¢ç„¶å¯„å­˜å™¨è¿™ä¹ˆå¿«ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨å¯„å­˜å™¨æ›¿ä»£å†…å­˜ï¼Œå¤–å­˜ç­‰</p>
<ul>
<li>ğŸ’°</li>
<li>é’ˆå¯¹å­˜å‚¨è®¾è®¡çš„åˆ†å±‚ä½“ç³»æ¶æ„ï¼Œè¶Šåº•å±‚çš„å­˜å‚¨ä»‹è´¨å®¹é‡è¶Šå¤§ï¼Œé€Ÿåº¦è¶Šæ…¢</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002971.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ol type="1">
<li><strong>å¯„å­˜å™¨è¡¨ç¤º</strong>ï¼šåœ¨RISC-Vä¸­ï¼Œå¯„å­˜å™¨å¯ä»¥ç”¨â€˜xâ€™åŠ ä¸Šä¸€ä¸ªæ•°å­—ï¼ˆå¦‚x0ã€x1...x31ï¼‰æ¥è¡¨ç¤ºï¼Œæˆ–è€…ç”¨ç‰¹å®šçš„åå­—æ¥è¡¨ç¤ºã€‚
(RISCVä¸€å…±æœ‰32ä¸ªå¯„å­˜å™¨ï¼Œå¯„å­˜å™¨å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œéœ€è¦åœ¨å­˜å‚¨é‡ä»¥åŠè¯»å–é€Ÿåº¦åšæƒè¡¡)</li>
<li><strong>å¯„å­˜å™¨ç§ç±»</strong>ï¼š</li>
</ol>
<ul>
<li><strong>ç¨‹åºå‘˜å˜é‡å¯„å­˜å™¨</strong>ï¼šè¿™ç±»å¯„å­˜å™¨ç”¨äºä¿å­˜ç¨‹åºä¸­çš„å˜é‡ã€‚
<ul>
<li>s0-s1 å¯¹åº” x8-x9</li>
<li>s2-s11 å¯¹åº” x18-x27</li>
</ul></li>
<li><strong>ä¸´æ—¶å˜é‡å¯„å­˜å™¨</strong>ï¼šè¿™ç±»å¯„å­˜å™¨ç”¨äºæš‚æ—¶ä¿å­˜æ•°æ®ã€‚
<ul>
<li>t0-t2 å¯¹åº” x5-x7</li>
<li>t3-t6 å¯¹åº” x28-x31</li>
</ul></li>
</ul>
<ol start="3" type="1">
<li><strong>å¯„å­˜å™¨ç±»å‹</strong>ï¼šRISC-Vä¸­çš„å¯„å­˜å™¨æ²¡æœ‰ç±»å‹ï¼ˆä¸Cè¯­è¨€çš„æ¦‚å¿µç›¸åï¼‰ã€‚æ‰§è¡Œçš„æ“ä½œå†³å®šäº†å¦‚ä½•å¤„ç†å¯„å­˜å™¨çš„å†…å®¹ã€‚</li>
</ol>
<p>åœ¨RISC-Væ¶æ„ä¸­ï¼Œx0-x7çš„å¯„å­˜å™¨æœ‰ç‰¹å®šçš„ç”¨é€”å’Œå‘½åï¼š</p>
<ul>
<li><strong>x0</strong>:
å¸¸è¢«ç§°ä¸º<code>zero</code>å¯„å­˜å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªç¡¬ç¼–ç çš„å¯„å­˜å™¨ï¼Œæ€»æ˜¯è¿”å›0ã€‚æ— è®ºä½ å°è¯•å†™å…¥ä»€ä¹ˆå€¼ï¼Œå®ƒéƒ½ä¼šä¿æŒä¸º0ã€‚</li>
<li><strong>x1</strong>:
é€šå¸¸è¢«ç§°ä¸º<code>ra</code>ï¼Œå³è¿”å›åœ°å€å¯„å­˜å™¨ã€‚å®ƒç”¨äºä¿å­˜å‡½æ•°è¿”å›åœ°å€ã€‚</li>
<li><strong>x2</strong>:
è¢«ç§°ä¸º<code>sp</code>ï¼Œå³å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨ã€‚å®ƒæŒ‡å‘å½“å‰å †æ ˆçš„é¡¶éƒ¨ã€‚</li>
<li><strong>x3</strong>:
è¢«ç§°ä¸º<code>gp</code>ï¼Œå³å…¨å±€æŒ‡é’ˆå¯„å­˜å™¨ã€‚å®ƒé€šå¸¸ç”¨äºæŒ‡å‘å…¨å±€å˜é‡ã€‚</li>
<li><strong>x4</strong>:
è¢«ç§°ä¸º<code>tp</code>ï¼Œå³çº¿ç¨‹æŒ‡é’ˆå¯„å­˜å™¨ã€‚å®ƒç”¨äºæŒ‡å‘çº¿ç¨‹ç›¸å…³çš„æ•°æ®ã€‚</li>
<li><strong>x5-x7</strong>:
è¿™äº›æ˜¯<code>t0-t2</code>ä¸´æ—¶å¯„å­˜å™¨ï¼Œä¸»è¦ç”¨äºç¼–è¯‘å™¨çš„ä¸­é—´æ“ä½œã€‚</li>
</ul>
<h2 id="assembly-code">Assembly code</h2>
<ul>
<li><code>opt</code> <code>dst</code>, <code>src1</code>,
<code>src2</code></li>
<li>cä¸­çš„å•è¡Œä»£ç å¯èƒ½åœ¨<code>RSIC-V</code>ä¸­åˆ†è§£ä¸ºå¤šä¸ªä¸åŒçš„æŒ‡ä»¤</li>
</ul>
<h3 id="basic-arithmetic-instructions">Basic Arithmetic
Instructions</h3>
<ul>
<li><p>ä¾‹å¦‚cè¯­è¨€ä¸­çš„ <code>a = b + c</code> | <code>a = b - c</code> |
<code>a =  (b+c)  - (d+e)</code></p></li>
<li><p><code>add s1, s2, s3</code> | <code>sub s1, s2, s3</code> |
<code>add t1, s2, s3</code> <code>add t2, s4, s5</code>
<code>sub s1, t1, t2</code></p></li>
<li><p>æœ‰æ—¶å€™æ”¹å˜æŒ‡ä»¤çš„é¡ºåºæœ‰åŠ©äºæé«˜æ‰§è¡Œæ•ˆç‡ï¼Œä½†æŸäº›æŒ‡ä»¤æ˜¯ä¸å¯ä»¥éšä¾¿äº¤æ¢çš„</p></li>
<li><p>ç«‹å³æ•°æ“ä½œï¼ˆæ€è€ƒä¸ºä»€ä¹ˆæ²¡æœ‰subiæ“ä½œï¼‰</p>
<ul>
<li><code>addi s1,s2,2</code> | <code>a = b + 2</code>;</li>
<li><code>addi s3,s3,1</code> | <code>c++</code>;</li>
<li>ç«‹å³æ•°å‡æ³•å¯ä»¥é€šè¿‡ç»„åˆç«‹å³æ•°åŠ æ³•å’Œè´Ÿçš„ç«‹å³æ•°ï¼Œè¿™å‡å°‘äº†æŒ‡ä»¤é›†çš„å¤æ‚æ€§</li>
</ul></li>
<li><p>ä»å†…å­˜ä¸­å­˜æˆ–è€…è¯»æ•°æ®</p>
<ul>
<li><code>memop reg, off(bAddr)</code> ï¼ˆå†…å­˜æ“ä½œç¬¦
<code>ç›®æ ‡å¯„å­˜å™¨/æ“ä½œå¯„å­˜å™¨</code>
offæ˜¯ä¸€ä¸ªä»¥<code>Byte</code>ä¸ºå•ä½çš„åç§»é‡ï¼Œ<code>bAddr</code>ä¸€ä¸ªå­˜å‚¨å†…å­˜åŸºåœ°å€çš„å¯„å­˜å™¨</li>
<li><strong>A register holds a word of raw data (no type)</strong>:
å¯„å­˜å™¨å­˜å‚¨çš„æ˜¯åŸå§‹æ•°æ®ï¼Œæ²¡æœ‰æ•°æ®ç±»å‹çš„åŒºåˆ†ã€‚æ¢å¥è¯è¯´ï¼Œä¸åƒé«˜çº§ç¼–ç¨‹è¯­è¨€ä¸­çš„å˜é‡ï¼Œå®ƒä»¬å¯èƒ½æœ‰ä¸€ä¸ªæŒ‡å®šçš„æ•°æ®ç±»å‹ï¼ˆå¦‚æ•´æ•°ã€æµ®ç‚¹æ•°æˆ–å­—ç¬¦ï¼‰ï¼Œå¯„å­˜å™¨ä»…ä»…å­˜å‚¨ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œä¸å…³å¿ƒè¿™äº›æ•°æ®ä»£è¡¨ä»€ä¹ˆç±»å‹ã€‚</li>
<li><strong>Make sure to use a register (and offset) that point to a
valid memory address</strong>:
å½“ä½ ä½¿ç”¨å¯„å­˜å™¨æ¥è¡¨ç¤ºä¸€ä¸ªå†…å­˜åœ°å€æ—¶ï¼ˆä¾‹å¦‚åœ¨æ•°æ®ä¼ è¾“æŒ‡ä»¤ä¸­ï¼‰ï¼Œä½ éœ€è¦ç¡®ä¿è¯¥å¯„å­˜å™¨ä¸­çš„å€¼ï¼ˆä»¥åŠä¸ä¹‹ç›¸å…³çš„ä»»ä½•åç§»é‡ï¼‰ç¡®å®æŒ‡å‘ä¸€ä¸ªæœ‰æ•ˆçš„å†…å­˜ä½ç½®ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢å°è¯•è®¿é—®æ— æ•ˆæˆ–å—ä¿æŠ¤çš„å†…å­˜åŒºåŸŸï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–å…¶ä»–ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚</li>
<li>ä»offçš„ä½¿ç”¨æ–¹æ³•å¯ä»¥çœ‹åˆ°ï¼Œæ±‡ç¼–ä¸æä¾›ç±»ä¼¼cè¯­è¨€<code>p++</code>è‡ªåŠ¨åç§»å¯¹åº”ç±»å‹çš„æ“ä½œï¼Œæ•°æ®çš„å¤§å°éœ€è¦è‡ªå·±è€ƒè™‘ã€‚</li>
<li>a[10] = a[3] + b -&gt; <code>lw t1,12(s1)</code>
<code>addi t1,t1,s2</code> <code>sw t1, 40(s1)</code></li>
</ul></li>
<li><p>æ€ä¹ˆåœ¨å†…å­˜ä¸­ç”¨æ±‡ç¼–åˆå§‹åŒ–å€¼ ï¼ˆé€ äº†ä¸€ä¸ªæ•°ç»„ï¼‰
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">.data<br>    <span class="hljs-comment">// è¿™é‡Œåˆ›å»ºäº†ä¸‰ä¸ª32ä½çš„æ•´æ•°ï¼Œç„¶è€Œæˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„å®é™…åœ°å€</span><br>source:<br>    	.word <span class="hljs-number">3</span><br>        .word <span class="hljs-number">1</span><br>        .word <span class="hljs-number">4</span><br>.text<br>main:<br>    	la t1,source  <span class="hljs-comment">// æ‰€ä»¥å…ˆæŠŠsourceçš„åœ°å€æ‹¿åˆ° t1å¯„å­˜å™¨</span><br>        lw t2,<span class="hljs-number">0</span>(t1)   <span class="hljs-comment">// ç„¶åæŠŠå€¼ï¼ˆa[0]ï¼‰åŠ è½½åˆ°t2å¯„å­˜å™¨é‡Œ</span><br>        lw t3,<span class="hljs-number">4</span>(t1)   <span class="hljs-comment">// ç„¶åæŠŠå€¼ (a[1]) åŠ è½½åˆ°t3å¯„å­˜å™¨é‡Œ</span><br></code></pre></td></tr></table></figure></p></li>
<li><p>å­—ï¼ˆ32ä½ï¼‰ï¼Œå­—èŠ‚ï¼ˆ8ä½ï¼‰ï¼ŒåŠå­—ï¼ˆ16ä½ï¼‰ï¼Œæˆ‘ä»¬è®¨è®ºå¾€å¾€ç”¨<code>1Byte</code>æ¥è®¨è®ºå†…å­˜</p></li>
<li><p>RISC-Vçš„ä½æ‹“å±•æœ‰0å¡«å……ä»¥åŠé«˜ä½ç¬¦å·ä½å¡«å……ï¼Œæœ‰äº›æŒ‡ä»¤å¯èƒ½ç†è®ºä¸Šè¿›è¡Œäº†ä½æ‹“å±•ï¼Œä¾‹å¦‚<code>lui</code>æŒ‡ä»¤æ˜¯"Load
Upper
Immediate"çš„ç¼©å†™ï¼Œå®ƒç”¨äºå°†ä¸€ä¸ª20ä½çš„ç«‹å³æ•°å€¼åŠ è½½åˆ°ä¸€ä¸ªå¯„å­˜å™¨çš„ä¸Š20ä½ï¼ŒåŒæ—¶å°†å…¶ä¸‹12ä½æ¸…é›¶ï¼Œè¿™ä¸ªæŒ‡ä»¤å‰åæ“ä½œæ•°å®è´¨å‘ç”Ÿäº†ä½æ‹“å±•ï¼Œä½†æ˜¯å› ä¸ºæ²¡æœ‰å¤šä½™çš„ä½è¿›è¡Œæ‹“å±•ï¼Œæ‰€ä»¥å®é™…æ²¡æœ‰è¿›è¡Œä½æ‹“å±•ã€‚è€Œ<code>auipc</code>æ˜¯æŠŠä¸€ä¸ª20bitä½çš„æ•°åŠ è½½åˆ°<code>pc</code>ä¸­ï¼Œè‡³äºå…·ä½“çš„ä½æ•°è¦çœ‹<code>RISC-V</code>çš„å˜ç§</p></li>
<li><p><code>lb/sb</code> <code>ä¸€åˆ‡å†…å®¹éƒ½ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¡¨ç¤º</code></p>
<ul>
<li><code>lb s1, 1(s0)</code> ä»s0ä¸­æ‹¿ç¬¬äºŒä¸ªå­—èŠ‚
ï¼Œé€šè¿‡<code>ç¬¦å·</code>ä½æ‹“å±•å­˜å‚¨åˆ°s1ä¸­</li>
<li><code>sb s1, 2(s0)</code> æŠŠs1çš„æœ€ä½ä½å­˜åˆ°s0ä¸­çš„ç¬¬ä¸‰ä¸ªå­—èŠ‚</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002972.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li><code>lh/sh</code> å’Œ
<code>lb</code>ä»¥åŠ<code>sb</code>ä¸€æ ·ï¼Œä¸è¿‡æ“ä½œçš„æ˜¯åŠå­—ä¹Ÿå°±æ˜¯16ä½æ¯”ç‰¹ä½</li>
<li><code>lhu</code>å’Œ<code>lbu</code>ç”¨äºæ— ç¬¦å·æ•°çš„è¯»å–ï¼Œä½†æ˜¯å®ƒä»¬åªæ‰§è¡Œ0æ‹“å±•</li>
</ul>
<h3 id="control-flow">control flow</h3>
<ul>
<li>cæœ‰ä»£ç å—çš„æ¦‚å¿µï¼Œä½†RISC-Væ²¡æœ‰ï¼Œä½†æ˜¯å…·æœ‰labelçš„æ¦‚å¿µï¼Œä¾‹å¦‚<code>main:</code></li>
<li>labelæ˜¯å¯è·³è½¬çš„</li>
<li><code>beq reg1, reg2, label</code> Branch If Equal
ï¼Œå¦‚æœ<code>reg1 == reg2</code> [å¯„å­˜å™¨å†…çš„å€¼ç›¸ç­‰]
é‚£ä¹ˆè·³è½¬åˆ°labelï¼Œå¦åˆ™æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤</li>
<li><code>bne reg1, reg2, label</code> Branch If Not Equal ï¼Œ å¦‚æœ
<code>reg1 != reg2</code> [å¯„å­˜å™¨å†…çš„å€¼ç›¸åŒ]
é‚£ä¹ˆè·³è½¬åˆ°labelï¼Œå¦åˆ™æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤</li>
<li><code>j label</code> æ— æ¡ä»¶è·³è½¬åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002974.png" srcset="/img/loading.gif" lazyload
alt="æˆªå±2023-10-28 13.16.37.png" />
<figcaption aria-hidden="true">æˆªå±2023-10-28 13.16.37.png</figcaption>
</figure>
<ul>
<li><code>blt reg1,reg2, label</code> Branch Less Than, means &lt;, if
the value in reg1 is less than reg2, then go to label</li>
<li><code>bge reg1,reg2, label</code> Branch Greater Than or Equal &gt;=
<ul>
<li>ä¸ºä»€ä¹ˆä¸è®¾è®¡ä¸€ä¸ª&gt; æˆ–è€… &lt;= å‘¢ï¼Ÿ
è¿™å®Œå…¨å¯ä»¥é€šè¿‡äº¤æ¢å‚æ•°æ¥å®ç°ã€‚</li>
</ul></li>
<li>loop in RISC-V æœ‰è®¸å¤šå®ç°æ–¹æ³•ï¼Œå…³é”®å°±æ˜¯åˆ†æ”¯æ§åˆ¶</li>
<li>PC
<ol type="1">
<li><strong>Program Counter (PC)</strong>: PC æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ï¼Œå®ƒå­˜å‚¨ç€ CPU
ä¸‹ä¸€æ­¥è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ã€‚åœ¨é¡ºåºæ‰§è¡Œçš„ç¨‹åºä¸­ï¼Œæ¯æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼ŒPC
é€šå¸¸ä¼šè‡ªåŠ¨åŠ ä¸Šè¯¥æŒ‡ä»¤çš„é•¿åº¦ï¼Œä»è€ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</li>
<li><strong>Branches</strong>: Branches
æ˜¯æŒ‡æ§åˆ¶æµæŒ‡ä»¤ï¼Œå¦‚æ¡ä»¶åˆ†æ”¯å’Œæ— æ¡ä»¶è·³è½¬ã€‚å½“æ»¡è¶³æŸä¸ªæ¡ä»¶æ—¶ï¼Œå®ƒä»¬ä¼šä¿®æ”¹ PC
çš„å€¼ï¼Œä½¿å…¶è·³è½¬åˆ°ç¨‹åºçš„å¦ä¸€ä¸ªä½ç½®ï¼Œè€Œä¸æ˜¯é¡ºåºåœ°æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</li>
</ol>
<ul>
<li>å½“ CPU
æ‰§è¡Œåˆ°ä¸€ä¸ªåˆ†æ”¯æŒ‡ä»¤æ—¶ï¼Œå®ƒä¼šæ ¹æ®è¯¥æŒ‡ä»¤å’Œç»™å®šçš„æ¡ä»¶æ¥å†³å®šæ˜¯å¦ä¿®æ”¹ PC
çš„å€¼ã€‚å¦‚æœå†³å®šè·³è½¬ï¼Œåˆ™ PC
ä¼šè¢«è®¾ç½®ä¸ºç›®æ ‡åœ°å€ï¼Œè¿™å¯¼è‡´ç¨‹åºä»æ–°çš„åœ°å€ç»§ç»­æ‰§è¡Œã€‚å¦‚æœä¸è·³è½¬ï¼ŒPC
å°†æŒ‰å¸¸è§„é€’å¢ï¼Œç»§ç»­é¡ºåºæ‰§è¡Œã€‚</li>
<li>æ— æ¡ä»¶è·³è½¬ï¼ˆå¦‚ <code>jmp</code> æˆ– <code>j</code>
åœ¨æŸäº›æ±‡ç¼–è¯­è¨€ä¸­ï¼‰æ€»æ˜¯ä¼šä¿®æ”¹ PC çš„å€¼ã€‚</li>
<li>æ¡ä»¶åˆ†æ”¯ï¼ˆå¦‚ <code>beq</code>ã€<code>bne</code>
ç­‰ï¼‰åˆ™ä¼šæ ¹æ®æ¡ä»¶åˆ¤æ–­æ˜¯å¦ä¿®æ”¹ PCã€‚ ### Shifting Instructions <img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002975.png" srcset="/img/loading.gif" lazyload
alt="image.png" /></li>
</ul></li>
<li>æ²¡æœ‰ç®—æ•°å·¦ç§»æ˜¯å› ä¸ºç®—æ•°å·¦ç§»å’Œé€»è¾‘å·¦ç§»æ˜¯ä¸€æ ·çš„ï¼Œä½ä½éƒ½ä¼šè¢«å¡«å……ä¸º0</li>
<li>å¯¹äºç«‹å³æ•°è€Œè¨€ï¼Œå€¼åªèƒ½åœ¨0-31ä¹‹é—´ï¼ˆ32ä½æŒ‡ä»¤ï¼‰</li>
<li>å¯¹äºå¯„å­˜å™¨ä¸­çš„å€¼è€Œè¨€ï¼Œåªæœ‰ä½5ä½çš„å€¼ä¼šè¢«è¯»å–</li>
</ul>
<h3 id="other-instructions">other Instructions</h3>
<ul>
<li><code>mul dst, src1,src2</code> è®¡ç®—<code>src1</code> *
<code>src2</code> ,æŠŠ<code>ä½32ä½</code>å­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>mulh dst, src1, src2</code> æŠŠ<code>é«˜32ä½</code>
å­˜å‚¨åˆ°<code>dst</code>ä¸­</li>
<li><code>div dst, src1, src2</code> è®¡ç®—<code>src1 / src2</code>
,æŠŠå•†å­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>rem dst, src1, src2</code> è®¡ç®—<code>src1 / src2</code> ,
æŠŠä½™æ ‘å­˜å‚¨åˆ° <code>dst</code>ä¸­</li>
<li><code>and dst, src1, src2</code>
è®¡ç®—<code>src1 &amp; src2</code>ï¼ŒæŠŠç»“æœå­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>andi dst, src1, imm</code>
è®¡ç®—<code>src1 &amp; imm</code>ï¼ŒæŠŠç»“æœå­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>or dst, src1, src2</code>
è®¡ç®—<code>src1 | src2</code>ï¼ŒæŠŠç»“æœå­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>ori dst, src1, imm</code>
è®¡ç®—<code>src1 | imm</code>ï¼ŒæŠŠç»“æœå­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>xor dst, src1, src2</code>
è®¡ç®—<code>src1 ^ src2</code>ï¼ŒæŠŠç»“æœå­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>xori dst, src1, imm</code>
è®¡ç®—<code>src1 ^ imm</code>ï¼ŒæŠŠç»“æœå­˜åˆ°<code>dst</code>ä¸­</li>
<li><code>slt dst, reg1,reg2</code> å¦‚æœ<code>reg1&lt;reg2</code>,
åˆ™<code>dst</code>ä¸º<code>1</code>å¦åˆ™ä¸º<code>0</code></li>
<li><code>slti dst, reg1, imm</code> å¦‚æœ<code>reg1&lt;imm</code>,
åˆ™<code>dst</code>ä¸º<code>1</code>å¦åˆ™ä¸º<code>0</code></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002976.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h3 id="interact-with-os">Interact with os</h3>
<ul>
<li>åŸºäº<code>a0</code>å¯„å­˜å™¨ä¸<code>os</code>äº¤äº’</li>
<li><a
target="_blank" rel="noopener" href="https://github.com/ThaumicMekanism/venus/wiki/Environmental-Calls">https://github.com/ThaumicMekanism/venus/wiki/Environmental-Calls</a></li>
</ul>
<h1 id="lecture-7-more-about-assembly">Lecture 7 More about
assembly</h1>
<h2 id="pseudo-instructions">Pseudo-Instructions</h2>
<ul>
<li>ä¸åŒäºé«˜çº§è¯­è¨€ä¾‹å¦‚cï¼Œæ±‡ç¼–è¯­è¨€ä¸€å®šæ˜¯é’ˆå¯¹äºå…·ä½“ç¡¬ä»¶è€Œè¿è¡Œçš„</li>
<li>æˆ‘ä»¬æœ‰æ—¶å€™ä½¿ç”¨çš„æŒ‡ä»¤å¹¶ä¸æ˜¯â€œçœŸæ­£çš„æŒ‡ä»¤â€ï¼Œè€Œæ˜¯ä¸ºäº†æ–¹ä¾¿è®°å¿†è€Œåšäº†ä¸€å±‚æŠ½è±¡
<ul>
<li><code>mv dst, reg1</code> -&gt; <code>addi dst, reg1, 0</code>
ç§»åŠ¨å¯„å­˜å™¨ä¸­çš„ä¸€ä¸ªå€¼åˆ°å¦ä¸€ä¸ªå¯„å­˜å™¨ä¸­</li>
<li><code>li dst, imm</code> -&gt; <code>addi, lui</code>
åŠ è½½ä¸€ä¸ªç«‹å³æ•°åˆ°å¯„å­˜å™¨</li>
<li><code>la dst, label</code> -&gt; <code>auipc dst</code>
å°†æŒ‡å®šæ ‡ç­¾çš„åœ°å€åŠ è½½åˆ°å¯„å­˜å™¨</li>
<li><code>nop</code> -&gt; <code>addi x0, x0, 0</code>
ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002977.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>å¦‚ä½•å°†è¿™æ®µä»£ç è½¬åŒ–ä¸ºæ±‡ç¼–è¯­è¨€å‘¢ï¼Ÿ
<ul>
<li>æ˜ç¡®å†™ä¸‹æ¯ä¸€æ­¥</li>
<li>ä¸€æ­¥ä¸€æ­¥çš„è¿›è¡Œç¿»è¯‘</li>
<li>è¿›è¡ŒæŒ‡ä»¤ä¼˜åŒ– <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//   define *p, define *q       --&gt;  p-&gt;  s0,  q -&gt; s1    </span><br><span class="hljs-comment">//   loop                       --&gt;  Loop:</span><br><span class="hljs-comment">//   take *p                    --&gt;  lb t0,0(s0)</span><br><span class="hljs-comment">//   set to *q                  --&gt;  sb t0,0(s1)</span><br><span class="hljs-comment">//   p++                        --&gt;  addi s0,s0,1</span><br><span class="hljs-comment">//   q++                        --&gt;  addi s1,s1,1</span><br><span class="hljs-comment">//   if *q == &#x27;\0&#x27; else to loop --&gt;  beq s0,x0,next</span><br><span class="hljs-comment">//								--&gt;  j Loop</span><br><span class="hljs-comment">//   go to next 				--&gt;  next:</span><br></code></pre></td></tr></table></figure></li>
</ul></li>
<li>æˆ‘ä»¬çš„nextå‡ºç°äº†å†—ä½™ï¼Œå¯ä»¥ç”¨æ›´å°‘çš„æŒ‡ä»¤æ¥æè¿°</li>
</ul>
<h2 id="function-calling">function calling</h2>
<ul>
<li>å‡½æ•°è°ƒç”¨é€šç”¨æµç¨‹
<ul>
<li>å°†è¢«è°ƒç”¨å‡½æ•°éœ€è¦çš„å˜é‡å­˜å‚¨åˆ°å¯ä»¥è¢«è®¿é—®åˆ°çš„åœ°æ–¹ï¼ˆå¯„å­˜å™¨ï¼Œå†…å­˜ï¼‰</li>
<li>å°†æ§åˆ¶æƒè½¬ç§»ç»™è¢«è°ƒç”¨çš„å‡½æ•°</li>
<li>è¢«è°ƒç”¨å‡½æ•°è¯»å–ä¸€äº›éœ€è¦çš„èµ„æº</li>
<li>è¢«è°ƒç”¨å‡½æ•°æ‰§è¡Œè‡ªå·±çš„ä»»åŠ¡</li>
<li>è¢«è°ƒç”¨å‡½æ•°è¿”å›å€¼ï¼Œç„¶åæ¸…ç©ºèµ„æº</li>
<li>æ§åˆ¶å…ƒè¿”å›åˆ°è°ƒç”¨è€…èº«ä¸Š</li>
</ul></li>
<li>ä¼ å…¥çš„å‚æ•°å­˜åœ¨å“ªé‡Œï¼Œè¿”å›å€¼å­˜åœ¨å“ªé‡Œ
<ul>
<li>ä¼˜å…ˆä½¿ç”¨å¯„å­˜å™¨ <code>a0-a7</code> (ä¼ å‚)
ï¼Œ<code>a0-a1</code>(è¿”å›å€¼ï¼‰</li>
<li>å¦‚æœç©ºé—´ä¸å¤Ÿç”¨ï¼Œé‚£ä¹ˆç”¨æ ˆç©ºé—´</li>
</ul></li>
<li>å‡½æ•°ä¹‹é—´çš„æ§åˆ¶æƒæ˜¯å¦‚ä½•è½¬ç§»çš„
<ul>
<li><code>Jump (j)</code>ï¼šæ— æ¡ä»¶è·³è½¬åˆ°æ ‡ç­¾å¤„ã€‚è¿™æ˜¯ä¸€ä¸ªä¼ªæŒ‡ä»¤ï¼Œå®é™…ä¸Šæ˜¯
<code>jal x0 label</code> ,<code>x0</code>ä¸ä¼šè¢«ä¿®æ”¹
<ul>
<li>ç¤ºä¾‹ï¼š<code>j label1</code></li>
</ul></li>
<li><code>Jump and Link (jal)</code>ï¼šç”¨äºè°ƒç”¨å‡½æ•°ã€‚å®ƒå°†å½“å‰æŒ‡ä»¤çš„åœ°å€ä¿å­˜åˆ°è¿”å›åœ°å€å¯„å­˜å™¨ï¼Œå¹¶è·³è½¬åˆ°æŒ‡å®šæ ‡ç­¾ã€‚
<ul>
<li>ç¤ºä¾‹ï¼š<code>jal dst label</code></li>
</ul></li>
<li><code>Jump and Link Register (jalr)</code>ï¼šä¸<code>jal</code>ç›¸ä¼¼ï¼Œä½†å…è®¸æ›´çµæ´»çš„è·³è½¬åœ°å€ï¼Œåœ°å€æ˜¯ä»å¯„å­˜å™¨å’Œç«‹å³æ•°è®¡ç®—å¾—åˆ°çš„ã€‚
<ul>
<li>ç¤ºä¾‹ï¼š<code>jalr dst src imm</code>
å°†ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å­˜åˆ°<code>dst</code>ä¸­ï¼ˆé€šå¸¸æ˜¯<code>ra</code>ï¼‰ï¼Œè·³è½¬åˆ°<code>src + imm</code>çš„åœ°å€</li>
</ul></li>
<li><code>Jump Register (jr)</code>ï¼šæ— æ¡ä»¶è·³è½¬åˆ°æºå¯„å­˜å™¨æŒ‡å®šçš„åœ°å€ã€‚é€šå¸¸ç”¨äºä»å‡½æ•°è¿”å›ã€‚
<ul>
<li>ç¤ºä¾‹ï¼š<code>jr src</code>
ä¹Ÿæ˜¯ä¸€ä¸ªä¼ªæŒ‡ä»¤ï¼Œ<code>jalr x0, rs1, 0</code></li>
</ul></li>
<li><code>ra</code>ï¼šè¿”å›åœ°å€å¯„å­˜å™¨ã€‚ç”¨äºä¿å­˜ä»å“ªä¸ªåœ°å€è°ƒç”¨äº†å‡½æ•°ï¼Œä»¥ä¾¿åç»­å¯ä»¥è¿”å›ã€‚</li>
<li><code>sp</code>ï¼šä¸€ä¸ªæŒ‡å‘æ ˆé¡¶çš„æŒ‡é’ˆ</li>
</ul></li>
<li>å‡½æ•°è°ƒç”¨è€…ä¸è¢«è°ƒç”¨è€…è¯¥æ€ä¹ˆä¿è¯å¯„å­˜å™¨çš„å®‰å…¨ä½¿ç”¨ -&gt; åŸºäºç®€å•çš„çº¦å®š
<ul>
<li>Saved Registers (Callee Saved)
<ul>
<li><code>s0-s11</code></li>
<li><code>sp</code></li>
<li>è¿™äº›å¯„å­˜å™¨åœ¨è¢«è°ƒç”¨è€…è¿”å›å‰ï¼ˆcalleeï¼‰ï¼Œå¿…é¡»æŠŠSaved
Registersæ¢å¤åˆ°è°ƒç”¨ä¹‹å‰</li>
</ul></li>
<li>Volatile Registers ï¼ˆif needed Caller Savedï¼‰
<ul>
<li><code>t0-t6</code> å±€éƒ¨å˜é‡ç”¨</li>
<li><code>a0-a7</code> è¿”å›å€¼åŠä¼ å…¥å‚æ•°ç”¨</li>
<li><code>ra</code> è¿”å›åœ°å€å¯„å­˜å™¨</li>
<li><figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002978.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure></li>
</ul></li>
</ul></li>
<li>ä¾‹å­</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002979.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h1 id="lecture-8-risc-v-format">Lecture 8 RISC-V format</h1>
<p><a
target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2023/pdf/22918222/1698730134374-89704955-8d29-44c5-b9b9-af80d35e802f.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2023%2Fpdf%2F22918222%2F1698730134374-89704955-8d29-44c5-b9b9-af80d35e802f.pdf%22%2C%22name%22%3A%22lec08.pdf%22%2C%22size%22%3A14352933%2C%22ext%22%3A%22pdf%22%2C%22source%22%3A%22%22%2C%22status%22%3A%22done%22%2C%22download%22%3Atrue%2C%22taskId%22%3A%22u47969a60-abb8-4c09-983b-8b4e6ad5dec%22%2C%22taskType%22%3A%22upload%22%2C%22type%22%3A%22application%2Fpdf%22%2C%22__spacing%22%3A%22both%22%2C%22mode%22%3A%22title%22%2C%22id%22%3A%22u6001ded4%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22file%22%7D">lec08.pdf</a></p>
<ul>
<li>æœ€å¼€å§‹çš„ENIACèƒ½å¤Ÿåœ¨2mså†…è®¡ç®—ä¸¤ä¸ªåä½æ•°çš„ä¹˜æ³•ï¼Œä½†æ˜¯éœ€è¦ä¸¤åˆ°ä¸‰å¤©è®¾ç½®ç¨‹åº</li>
<li>ä¸ºä»€ä¹ˆä¸ç”¨bitæ¥è¡¨ç¤ºæŒ‡ä»¤å‘¢ï¼Ÿæ‰€æœ‰è¦æ‰§è¡Œçš„æŒ‡ä»¤å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿™æ˜¯ç°ä»£è®¡ç®—çš„æ ¸å¿ƒæ€æƒ³ã€‚
<ul>
<li>cè¯­è¨€çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯å†…å­˜ä¸­çš„æ•°æ®</li>
<li>PCæŒ‡å‘çš„æ˜¯å†…å­˜ä¸­çš„ä»£ç ã€æŒ‡ä»¤</li>
</ul></li>
<li>éšç€ç¡¬ä»¶çš„å‘å±•ï¼Œæˆ‘ä»¬æ—¢ä¸æƒ³æŠ›å¼ƒä»¥å‰çš„æŒ‡ä»¤é›†ï¼ŒåˆåŠ å…¥äº†æ–°çš„æŒ‡ä»¤é›†ï¼Œè¿™å¯¼è‡´äº†æŒ‡ä»¤é›†çš„è†¨èƒ€
<ul>
<li>å…¸å‹çš„ä¾‹å­å°±æ˜¯x86</li>
<li>æ±‡ç¼–å™¨æ›¿æˆ‘ä»¬æŠŠæ±‡ç¼–ä»£ç è½¬è¯‘ä¸ºæœºå™¨è¯­è¨€</li>
</ul></li>
<li>æˆ‘ä»¬æœ‰6ç§ä¸åŒçš„åˆ’åˆ†æ–¹æ³•ï¼Œå°†ä¸€ä¸ª32ä½çš„æŒ‡ä»¤åˆ’åˆ†ä¸ºä¸åŒæŒ‡ä»¤æ ¼å¼ï¼Œè¿™æ˜¯å¯¹<code>ç¡¬ä»¶ç®€åŒ–è®¾è®¡</code>ä»¥åŠ<code>å¤æ‚æŒ‡ä»¤è®¾è®¡</code>çš„å¦¥å
<ul>
<li><code>R-Format</code>
å®ç°æ‰€æœ‰éœ€è¦ä¸‰ä¸ªå¯„å­˜å™¨çš„ç®—æ•°ä¸é€»è¾‘æ“ä½œæŒ‡ä»¤</li>
<li><code>I-Format</code> å®ç°å¸¦æœ‰ç«‹å³æ•°çš„è¿ç®—æŒ‡ä»¤å’ŒåŠ è½½æŒ‡ä»¤</li>
<li><code>S-Format</code> å®ç°å°†å¯„å­˜å™¨çš„å€¼å†™å…¥åˆ°å†…å­˜ä¸­</li>
<li><code>U-Format</code>
å’Œ<code>I-Format</code>ç±»ä¼¼ï¼Œä½†æ˜¯ç«‹å³æ•°æ˜¯é«˜20ä½</li>
<li><code>SB-Format</code> åˆ†æ”¯æŒ‡ä»¤è®¾è®¡</li>
<li><code>Uj-Format</code> ç›´æ¥æ›´æ”¹ç¨‹åºæ‰§è¡Œåœ°å€</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002980.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li><code>funct7</code>ï¼Œ<code>funct3</code>
ç»„åˆèµ·æ¥ç”¨äºæŒ‡å®šå…·ä½“çš„æ“ä½œ</li>
<li><code>rs1</code>ï¼Œ<code>rs2</code>
åˆ™å­˜å‚¨äº†æ“ä½œæ•°ï¼Œ<code>rd</code>åˆ™æ ‡æ³¨äº†å†™å…¥ç»“æœçš„å¯„å­˜å™¨</li>
<li><code>imm</code>æ˜¯ç«‹å³æ•°ï¼Œå¯ä»¥çœ‹åˆ°æ’å¸ƒè§„åˆ™è¿˜æ˜¯å¾ˆå¥‡æ€ªçš„ï¼Œç”šè‡³è¿˜æœ‰ç¼©ä½ï¼Œä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†ç¡¬ä»¶</li>
<li><code>opcode</code>åˆ™å‘Šè¯‰æˆ‘ä»¬æŸæ¡æŒ‡ä»¤åˆ°åº•å±äºå“ªä¸€ç±»</li>
</ul>
<h2 id="r-format">R-Format</h2>
<ul>
<li>ä¸åŒçš„filedé•¿åº¦ä¸åŒï¼Œä½†éƒ½æ˜¯<del>æ— ç¬¦å·æ•°</del>ï¼Œä¼¼ä¹å¹¶ä¸æ˜¯ï¼Œimmæ˜¯ä»¥è¡¥ç çš„å½¢å¼å­˜å‚¨çš„</li>
<li>æˆ‘ä»¬æœ‰<span class="math inline">\(2^3 * 2^7 =
2^{10}\)</span>ä¸ªä¸åŒçš„<code>R-Format</code>æŒ‡ä»¤</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002981.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>æ‰€æœ‰<code>R-Format</code>æŒ‡ä»¤çš„æ“ä½œç éƒ½æ˜¯ä¸€è‡´çš„</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002982.png" srcset="/img/loading.gif" lazyload
title="funct7ï¼Œrs2ï¼Œrs1ï¼Œfunct3ï¼Œrdï¼Œopcode"
alt="funct7ï¼Œrs2ï¼Œrs1ï¼Œfunct3ï¼Œrdï¼Œopcode" />
<figcaption
aria-hidden="true">funct7ï¼Œrs2ï¼Œrs1ï¼Œfunct3ï¼Œrdï¼Œopcode</figcaption>
</figure>
<h2 id="i-format">I-Format</h2>
<ul>
<li>å½“å­˜åœ¨ç«‹å³æ•°æ—¶ï¼Œæ„å‘³ç€æˆ‘ä»¬çš„æŒ‡ä»¤ä¸­å¿…é¡»åŒ…å«ä¸€ä¸ªç«‹å³æ•°ï¼Œè€Œä¸æ˜¯å¯„å­˜å™¨çš„åœ°å€ï¼Œè€Œå¯¹äºæˆ‘ä»¬å·²ç»çŸ¥é“çš„<code>R-Format</code>æ¥è¯´ï¼Œç”¨5ä½æ¥è¡¨ç¤ºä¸€ä¸ªç«‹å³æ•°å¯ç”¨çš„èŒƒå›´å¤ªå°äº†</li>
<li>RISC-Vçš„è®¾è®¡ç†å¿µå¸Œæœ›æˆ‘ä»¬åªæœ‰ä¸€æ¡æŒ‡ä»¤ï¼Œä½†ç°åœ¨æˆ‘ä»¬éœ€è¦è¿èƒŒè¿™ä¸ªç†å¿µï¼Œéœ€è¦ä¸€ä¸ªä¸åŒçš„æ ¼å¼</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002983.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li><code>func7</code>å’Œ<code>rs2</code>è¢«ç”¨äºè¡¨ç¤ºä¸€ä¸ªç«‹å³æ•°ï¼Œå…¶ä»–çš„filedå’Œ<code>R-Format</code>ä¿æŒä¸€è‡´</li>
<li><code>imm</code>æ¯æ¬¡åœ¨è¿›è¡Œç®—æ•°è¿ç®—æ—¶éƒ½ä¼šç”±12ä½æ•°æ‹“å±•ä¸º32ä½</li>
<li><code>imm</code>çš„èŒƒå›´æ˜¯<span class="math inline">\([-2^{11},
+2^{11}-1]\)</span></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002984.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li><p>å¯¹äºç‰¹æ®Šçš„ç§»ä½æ“ä½œï¼Œåªä½¿ç”¨ä½äº”ä½ä»£è¡¨ç§»åŠ¨çš„ä½æ•°</p></li>
<li><p>ç”¨<code>1</code>å’Œ<code>0</code>åŒºåˆ«ç®—æ•°å³ç§»å’Œé€»è¾‘å³ç§»</p></li>
<li><p>Load - Instructions ä¹Ÿæ˜¯I-Formatç±»å‹çš„æŒ‡ä»¤</p></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002985.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>ä»<code>rs1</code>ä¸­å–å‡ºå†…å­˜ä¸­çš„åŸºåœ°å€ï¼Œä¸åç§»é‡ç›¸åŠ åå–å‡ºå€¼æ”¾åˆ°<code>dst</code>ä¸­</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002986.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>jalrä¹Ÿæ˜¯Iç±»å‹çš„æŒ‡ä»¤</li>
<li>éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼Œè¿™é‡Œçš„åç§»é‡å•ä½å°±æ˜¯å­—èŠ‚ï¼Œä¸éœ€è¦ä¹˜ä»¥2å­—èŠ‚è¿›è¡Œå¯¹é½ï¼Œè·³è½¬ç²’åº¦æ˜¯å­—èŠ‚ä¸ºå•ä½çš„</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002987.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h2 id="s-format">S-Format</h2>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002988.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>å»æ‰ç›®æ ‡å¯„å­˜å™¨ï¼Œæ›´æ”¹ä¸ºç«‹å³æ•°çš„ä½5ä½</li>
<li>åŠŸèƒ½å°±æ˜¯åœ¨<code>rs1</code>åœ°å€åŠ ä¸Šåç§»é‡çš„ä½ç½®å†™å…¥<code>rs2</code>çš„å†…å®¹</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002989.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h2 id="sb-format">SB-Format</h2>
<ul>
<li>ä¸€èˆ¬ç”¨äºå¾ªç¯æˆ–è€…æµç¨‹æ§åˆ¶ï¼Œå¾ªç¯ä¸€èˆ¬ä¼šå°äº50æ¡æŒ‡ä»¤</li>
<li>åˆ†æ”¯è·ç¦» ä»å½“å‰åˆ†æ”¯æŒ‡ä»¤åˆ°ç›®æ ‡ä½ç½®çš„è·ç¦» ä¸€èˆ¬ç”¨å­—èŠ‚æˆ–è€…æŒ‡ä»¤æè¿°
<ul>
<li>è¿™ä¸ªå¤§å°æ”¶åˆ°ä»£ç æ®µå¤§å°çš„é™åˆ¶ï¼ˆä»£ç æ®µæœ¬èº«çš„å¤§å°ï¼Œä¸å¯ä»¥è·³åˆ°ä»£ç æ®µä¹‹å¤–çš„ä½ç½®ï¼‰</li>
<li><code>PC</code>å­˜å‚¨äº†å½“å‰æŒ‡ä»¤çš„åœ°å€ï¼Œå…·ä½“è·³è½¬çš„ä½ç½®ç”±å½“å‰<code>PC</code>å†…çš„åœ°å€åœ¨<span
class="math inline">\([-2^{11},+2^{11]}\)</span>å¯¹é½çš„ä½ç½®è¿›è¡Œè·³è½¬ï¼ˆä¸å¯¹é½ä¼šå¼•å‘æ€§èƒ½é—®é¢˜ï¼‰ï¼Œå¹¶ä¸”è·³è½¬çš„è·ç¦»å¿…é¡»æ˜¯4Byteçš„æ•´æ•°å€
<ul>
<li>RISC-Vä½¿ç”¨32ä½åœ°å€ï¼šè¿™æ„å‘³ç€å®ƒä½¿ç”¨32ä½æ¥è¡¨ç¤ºå†…å­˜åœ°å€ã€‚</li>
<li>å†…å­˜æ˜¯æŒ‰å­—èŠ‚å¯»å€çš„ï¼šå³æ¯ä¸ªåœ°å€å¯¹åº”ä¸€ä¸ªå­—èŠ‚ã€‚</li>
<li>32ä½æŒ‡ä»¤æ˜¯â€œword-alignedâ€ï¼šè¿™æ„å‘³ç€æ¯ä¸ª32ä½æŒ‡ä»¤çš„åœ°å€éƒ½æ˜¯4çš„å€æ•°ï¼ˆå› ä¸ºä¸€ä¸ªå­—æ˜¯4ä¸ªå­—èŠ‚ï¼‰ã€‚ä¾‹å¦‚ï¼Œ0x1000,
0x1004, 0x1008 ç­‰éƒ½æ˜¯æœ‰æ•ˆçš„æŒ‡ä»¤åœ°å€ï¼Œè€Œ0x1001, 0x1002, 0x1003
ç­‰åˆ™ä¸æ˜¯ã€‚</li>
<li>ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰å§‹ç»ˆæŒ‡å‘ä¸€ä¸ªæŒ‡ä»¤ï¼šè¿™æ˜¯è®¡ç®—æœºç¡¬ä»¶è®¾è®¡çš„åŸºæœ¬åŸåˆ™ï¼Œç¡®ä¿ç¨‹åºèƒ½å¤Ÿé¡ºåºåœ°æ‰§è¡ŒæŒ‡ä»¤ã€‚</li>
<li>RISC-Vçš„å‹ç¼©æŒ‡ä»¤ï¼šå¦‚æœç³»ç»Ÿæ”¯æŒRISC-Vçš„å‹ç¼©æŒ‡ä»¤ï¼ˆè¿™äº›æŒ‡ä»¤åªæœ‰16ä½é•¿ï¼‰ï¼Œé‚£ä¹ˆæ‰€æœ‰æŒ‡ä»¤éƒ½æ˜¯â€œhalf
word-alignedâ€ï¼Œå³æŒ‡ä»¤çš„åœ°å€æ˜¯2çš„å€æ•°ã€‚</li>
</ul></li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002990.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>ISA æŒ‡ä»¤é›†çš„æŠ½è±¡ä½“ç³»ç»“æ„
ä¸ºåŒä¸€ISAç¼–å†™çš„ç¨‹åºå¯ä»¥åœ¨ä¸åŒçš„ISAçš„å®ç°å¹³å°ä¸Šè¿è¡Œ</li>
<li>æ‹“å±•çš„RISC-Væ”¯æŒ16ä½çš„å‹ç¼©æŒ‡ä»¤ï¼Œä¸ºäº†å¯¹é½å…¼å®¹ï¼Œå› æ­¤åˆ†æ”¯æŒ‡ä»¤çš„åç§»é‡ä»¥åŠå­—ä¸ºå•ä½ï¼Œæ— è®ºä½ æœ‰æ²¡æœ‰ç”¨åˆ°16ä½å‹ç¼©æŒ‡ä»¤</li>
<li>ä»å½“å‰æŒ‡ä»¤æœ€å¤§åªèƒ½å®ç°<span
class="math inline">\(2^{10}\)</span>æ¡32ä½æŒ‡ä»¤çš„è·³è½¬ï¼Œåç§»é‡çš„å•ä½æ˜¯åŠå­—ï¼ˆ16ä½bitï¼Œ2Byteï¼‰
<ul>
<li>ä¸ºä»€ä¹ˆä¸ç”¨ä¸€ä¸ªå­—å‘¢ï¼Ÿ ï¼ˆå…¼å®¹16ä½ï¼Œä»¥åŠå¯ä»¥ç¼©å‡æ‰€å ç”¨ç©ºé—´çš„å¤§å°ï¼‰</li>
<li>Immå®é™…è¡¨ç¤ºçš„æ˜¯13ä½çš„åç§»ï¼Œå®é™…çš„åç§»é‡æ—¢immæ‰€è¡¨ç¤ºçš„ç«‹å³æ•°<em>2ï¼ˆæˆ–è€…å‘æœ€ä½ä½è¡¥ä¸€ä¸ªé›¶ï¼‰</em>2Byte
<ul>
<li>ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·ï¼Ÿå› ä¸ºæˆ‘ä»¬çš„åç§»é‡çš„æœ€åä¸€ä½æ€»ä¼šæ˜¯é›¶ï¼ˆRISC-Væ˜¯4å­—èŠ‚æˆ–2å­—èŠ‚å¯¹é½çš„æŒ‡ä»¤ï¼‰</li>
</ul></li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002991.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li><code>filed1</code>çš„æœ€é«˜ä½å­˜å‚¨åç§»é‡çš„ç¬¬12ä½ï¼Œå‰©ä½™çš„ä½å­˜ç¬¬10-5ä½</li>
<li><code>filed5</code>çš„å‰4ä½å­˜å‚¨åç§»é‡çš„1-4ä½ï¼Œæœ€åä¸€ä½å­˜ç¬¬11ä½</li>
<li>è¿™ååˆ†åœ°åˆ«æ‰­ï¼Œä½†ä¸€åˆ‡éƒ½æ˜¯åŸºäºç¡¬ä»¶çš„è€ƒé‡</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002992.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>SBæŒ‡ä»¤å®ç°è·³è½¬æ˜¯åŸºäºPCå¯„å­˜å™¨çš„ç›¸å¯¹å¯»å€æ–¹å¼
<ul>
<li>æ•´ä¸ªä»£ç åŒºçš„ç§»åŠ¨ä¸ä¼šå¯¼è‡´ç«‹å³æ•°çš„æ”¹å˜ï¼ˆéƒ¨åˆ†ä»£ç ä¼šï¼‰</li>
<li>å½“æˆ‘ä»¬è¦è·³è½¬çš„æŒ‡ä»¤èŒƒå›´å¤§äºäº†<span
class="math inline">\(2^{10}\)</span>æ¡32ä½çš„æŒ‡ä»¤ï¼Œé‚£ä¹ˆå°†ä¼šä½¿ç”¨JæŒ‡ä»¤è¿›è¡Œè·³è½¬ï¼ŒJæŒ‡ä»¤å…·æœ‰æ›´å¤§çš„è·³è½¬èŒƒå›´</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002993.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h2 id="u-format">U-Format</h2>
<ul>
<li>I-FormatæŒ‡ä»¤åªç»™äº†æˆ‘ä»¬12ä½çš„ç«‹å³æ•°ï¼Œå‡å¦‚æˆ‘ä»¬éœ€è¦ç”¨åˆ°æ›´å¤§çš„ç«‹å³æ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åˆ°U-FormatæŒ‡ä»¤</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002994.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>åŠ è½½32ä½ç«‹å³æ•°çš„é«˜20ä½åˆ°ç¨‹åºå¯„å­˜å™¨/PCä¸­ï¼Œå‰©ä½™çš„ä½ç½®è¡¥0</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002995.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>åŠ è½½è¿™ä¸ª32ä½çš„ç«‹å³æ•°å‡ºç°äº†é—®é¢˜ï¼ŒåŸå› æ˜¯<code>addi</code>å¯¹è¦åŠ è½½çš„ç«‹å³æ•°è¿›è¡Œäº†ç¬¦å·æ‹“å±•ï¼Œè¿™å¯¼è‡´å®é™…ä¸Šæˆ‘ä»¬è®¡ç®—çš„æ˜¯<code>0xDEADB000</code>+<code>0xFFFFFEEF</code></li>
<li>æˆ‘ä»¬åªéœ€è¦åœ¨å¤„ç†éœ€è¦ç¬¦å·æ‹“å±•çš„<code>addi</code>å¯¹<code>0xDEADB</code>åç§»ä¸€æ¬¡å°±å¥½ï¼Œå³å¾—åˆ°<code>0xDEADC</code>
+ <code>0xFFFFFEEF</code> = <code>0xDEADBEEF</code></li>
<li>AUIPCæ˜¯æŠŠç«‹å³æ•°çš„é«˜ä½å’ŒPCç›¸åŠ å¹¶å­˜åˆ°dstå¯„å­˜å™¨ä¸­</li>
</ul>
<h2 id="uj-format">UJ-Format</h2>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002996.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>æŠŠPC+4 å­˜åˆ°dsté‡Œ</li>
<li>ä»¤PC = PC + offset</li>
<li>æœ€å¤§å¯è·³è¿‡<span class="math inline">\(2^{19}\)</span>ä¸ª
16ä½æŒ‡ä»¤ï¼Œå³<span class="math inline">\(2^{18}\)</span>ä¸ª32ä½çš„æŒ‡ä»¤</li>
<li><code>J</code>æ˜¯ä¼ªæŒ‡ä»¤ï¼Œè¿˜æ˜¯åŸºäº<code>JAL</code>ï¼Œåˆ©ç”¨äº†<code>x0</code>å¯„å­˜å™¨ä¸ä¼šè¢«ä¿®æ”¹çš„ç‰¹ç‚¹</li>
<li>immçš„ç¼–ç è¿˜æ˜¯ååˆ†æ··ä¹±ï¼Œå†æ¬¡å¼ºè°ƒï¼Œè¿™æ˜¯ä¸ºäº†é™ä½ç¡¬ä»¶æˆæœ¬</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002997.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>çœ‹èµ·æ¥å°±å¾ˆç¡¬ä»¶å‹å¥½ï¼Œä¾‹å¦‚opcodeçš„ä½ç½®ï¼Œrdï¼Œrsçš„ä½ç½®éƒ½æ˜¯å¯¹é½çš„</p>
<h1 id="lecture-9-call">Lecture 9 CALL</h1>
<p><a
target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2023/pdf/22918222/1698909449654-f25c0253-547f-4ac1-884a-7f85cc0bc54e.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2023%2Fpdf%2F22918222%2F1698909449654-f25c0253-547f-4ac1-884a-7f85cc0bc54e.pdf%22%2C%22name%22%3A%22lec09-2.pdf%22%2C%22size%22%3A8406067%2C%22ext%22%3A%22pdf%22%2C%22source%22%3A%22%22%2C%22status%22%3A%22done%22%2C%22download%22%3Atrue%2C%22taskId%22%3A%22ucedb2fc9-46d6-493a-935e-c969e717e2e%22%2C%22taskType%22%3A%22upload%22%2C%22type%22%3A%22application%2Fpdf%22%2C%22__spacing%22%3A%22both%22%2C%22mode%22%3A%22title%22%2C%22id%22%3A%22ub5a4e767%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22file%22%7D">lec09-2.pdf</a></p>
<ul>
<li><p>Compiler</p></li>
<li><p>Assembler</p></li>
<li><p>Linker</p></li>
<li><p>Loader ## Translation</p></li>
<li><p>å½“æˆ‘ä»¬ç¼–å†™ç¨‹åºåï¼Œæœ‰ä¸¤ç§æ–¹æ³•è¿è¡Œæˆ‘ä»¬ç¼–å†™çš„è¿è¡Œç¨‹åº</p>
<ul>
<li>è§£é‡Š ï¼šè¾¹è§£é‡Šè¾¹è¿è¡Œ ä¾‹å¦‚python<br />
</li>
<li>ç¿»è¯‘ï¼š è½¬æ¢ä¸ºå¦ä¸€ç§ç­‰ä»·è¯­è¨€æ¥è¿è¡Œ ä¾‹å¦‚c</li>
<li>å½“å…·æœ‰æ€§èƒ½çš„è€ƒé‡çš„æ—¶å€™ï¼Œç”¨translate</li>
<li>è§£é‡Šè¯­è¨€å¾€å¾€æ€§èƒ½æ…¢ä¸€äº› 10xï¼Œä½†æ˜¯ä»£ç å°‘ 2x</li>
</ul></li>
</ul>
<h2 id="compiler">Compiler</h2>
<ul>
<li>å°†.cæºæ–‡ä»¶è¾“å‡ºä¸º.sæ±‡ç¼–æ–‡ä»¶ï¼ˆå¯èƒ½åŒ…å«ä¼ªæŒ‡ä»¤ï¼‰
<ul>
<li>é¢„å¤„ç†ï¼Œä¾‹å¦‚å®æ›¿æ¢ï¼Œå¤´æ–‡ä»¶åŒ…å«</li>
<li>ç¡®å®šè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ a = 3+ 4*2</li>
<li>...éå¸¸å¤æ‚</li>
<li><a
target="_blank" rel="noopener" href="https://www.sigbus.info/how-i-wrote-a-self-hosting-c-compiler-in-40-days">https://www.sigbus.info/how-i-wrote-a-self-hosting-c-compiler-in-40-days</a></li>
</ul></li>
</ul>
<h2 id="assembler">Assembler</h2>
<ul>
<li>å°†.sçš„æ±‡ç¼–æ–‡ä»¶è¾“å‡ºä¸º.oäºŒè¿›åˆ¶æ–‡ä»¶
<ul>
<li>è¯»å’Œä½¿ç”¨Directives ï¼ˆåŒºåˆ†ä»£ç æ®µ, æ–‡æœ¬æ®µï¼ŒæŒ‡ä»¤ç­‰ï¼‰
<ul>
<li>Directiveså¹¶ä¸ä¼šè¢«è½¬æ¢ä¸ºæœºå™¨ä»£ç </li>
<li>text:
è¯¥æŒ‡ä»¤åçš„é¡¹ç›®è¢«æ”¾ç½®åœ¨ç”¨æˆ·æ–‡æœ¬æ®µä¸­ã€‚é€šå¸¸ï¼Œè¿™æ˜¯ç¨‹åºçš„æœºå™¨ä»£ç éƒ¨åˆ†ï¼Œå³å®é™…çš„æŒ‡ä»¤ã€‚</li>
<li>.data:
è¯¥æŒ‡ä»¤åçš„é¡¹ç›®è¢«æ”¾ç½®åœ¨ç”¨æˆ·æ•°æ®æ®µä¸­ã€‚è¿™æ˜¯ç¨‹åºä¸­çš„é™æ€æ•°æ®ï¼Œå¦‚å˜é‡å’Œå¸¸é‡ã€‚å®ƒå­˜å‚¨æºæ–‡ä»¶ä¸­æ•°æ®çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚</li>
<li>.globl sym:
è¿™å£°æ˜äº†ä¸€ä¸ªå…¨å±€ç¬¦å·ï¼Œè¿™æ„å‘³ç€è¯¥ç¬¦å·å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶ä¸­è¢«å¼•ç”¨ã€‚ä¾‹å¦‚ï¼Œè¿™å¯ä»¥æ˜¯ä¸€ä¸ªåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰ä½†åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨çš„å‡½æ•°æˆ–å˜é‡ã€‚</li>
<li>.asciiz str:
è¿™å°†å­—ç¬¦ä¸²strå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶åœ¨å…¶åæ·»åŠ ä¸€ä¸ªnullç»ˆæ­¢ç¬¦ã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•ï¼Œç”¨äºåœ¨Cè¯­è¨€ä¸­è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œå› ä¸ºCè¯­è¨€çš„å­—ç¬¦ä¸²æ˜¯ä»¥nullå­—ç¬¦ï¼ˆå€¼ä¸º0çš„å­—ç¬¦ï¼‰ç»ˆæ­¢çš„ã€‚</li>
<li>.word w1...wn: è¿™å°†è¿ç»­çš„nä¸ª32ä½çš„æ•°å€¼å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜å•å…ƒä¸­ã€‚</li>
</ul></li>
<li>æ›¿æ¢ä¼ªæŒ‡ä»¤</li>
<li>è½¬æ¢ä¸ºæœºå™¨è¯­è¨€ï¼ˆè¾“å‡ºä¸ºç›®æ ‡æ–‡ä»¶ï¼‰
<ul>
<li>åœ¨é“¾æ¥ä»¥å‰ï¼Œéœ€è¦è§£å†³ä¸€ä¸ªç¬¦å·å¼•ç”¨çš„é—®é¢˜ï¼Œä¾‹å¦‚labelçš„è·³è½¬ï¼Œä»å®é™…çš„å†…å­˜ä¸­åŠ è½½æ•°æ®ï¼Œè¿™äº›éœ€è¦ç²¾ç¡®çš„32ä½å†…å­˜ï¼Œè€Œæˆ‘ä»¬åœ¨æ±‡ç¼–é˜¶æ®µæ˜¯ä¸å¯èƒ½ç¡®å®šçš„ã€‚è¿™ä¹Ÿå«åšå‰å‘å¼•ç”¨é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ç»´æŠ¤ä¸€ä¸ª<code>ç¬¦å·è¡¨</code>
å’Œä¸€ä¸ª<code>é‡å®šä½è¡¨</code>ï¼Œè¿è¡Œå¤šæ¬¡<code>Assembler</code>æ¥è§£å†³ã€‚</li>
<li>ç›®æ ‡æ–‡ä»¶åœ¨<code>unix</code>å’Œ<code>Linux</code>
å¹³å°å¾€å¾€æ˜¯<code>ELF</code>æ ¼å¼çš„</li>
<li>å¯¹è±¡æ–‡ä»¶å¤´ (object file
header)ï¼šè¿™æ˜¯ç›®æ ‡æ–‡ä»¶çš„å…ƒä¿¡æ¯éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†æ–‡ä»¶ä¸­å…¶ä»–éƒ¨åˆ†çš„å¤§å°å’Œä½ç½®ã€‚æ­¤å¤´éƒ¨æ ‡è¯†äº†æ–‡ä»¶çš„ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œæ˜¯å¦æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼Œè¿˜æ˜¯ä¸€ä¸ªå…±äº«åº“ï¼‰ä»¥åŠå…¶ä»–å…³äºæ–‡ä»¶çš„åŸºæœ¬å±æ€§ã€‚</li>
<li>æ–‡æœ¬æ®µ (text
segment)ï¼šè¿™éƒ¨åˆ†åŒ…å«ç¨‹åºçš„å®é™…æœºå™¨ä»£ç ã€‚å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œè¿™éƒ¨åˆ†ä»£ç ä¼šè¢«åŠ è½½åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚</li>
<li>æ•°æ®æ®µ (data
segment)ï¼šæ­¤éƒ¨åˆ†åŒ…å«ç¨‹åºçš„é™æ€æ•°æ®å’Œå…¨å±€å˜é‡ã€‚åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå®ƒä»¬ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä¾›ç¨‹åºè®¿é—®å’Œä¿®æ”¹ã€‚</li>
<li>é‡å®šä½è¡¨ (relocation
table)ï¼šå¦‚å‰æ‰€è¿°ï¼Œé‡å®šä½è¡¨åˆ—å‡ºäº†æ‰€æœ‰éœ€è¦åœ¨è¿æ¥æ—¶æˆ–è¿è¡Œæ—¶è¢«â€œå¤„ç†â€æˆ–â€œä¿®å¤â€çš„ä»£ç ä½ç½®ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¸çŸ¥é“æ‰€æœ‰å¤–éƒ¨å¼•ç”¨çš„ç¡®åˆ‡å†…å­˜åœ°å€ã€‚</li>
<li>ç¬¦å·è¡¨ (symbol
table)ï¼šæ­¤è¡¨åŒ…å«æ–‡ä»¶ä¸­å®šä¹‰å’Œå¼•ç”¨çš„æ‰€æœ‰ç¬¦å·ï¼ˆä¾‹å¦‚å‡½æ•°åå’Œå˜é‡åï¼‰çš„åˆ—è¡¨ã€‚å®ƒå¸®åŠ©é“¾æ¥å™¨è§£æå¤–éƒ¨å’Œå†…éƒ¨ç¬¦å·å¼•ç”¨ï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„é“¾æ¥ã€‚</li>
<li>è°ƒè¯•ä¿¡æ¯ (debugging
information)ï¼šå¯¹äºé‚£äº›ç¼–è¯‘æ—¶å¸¦æœ‰è°ƒè¯•ä¿¡æ¯çš„æ–‡ä»¶ï¼Œè¿™éƒ¨åˆ†åŒ…å«äº†æºä»£ç çº§åˆ«çš„ä¿¡æ¯ï¼Œå¦‚å˜é‡åã€è¡Œå·ç­‰ã€‚è¿™ä½¿å¾—è°ƒè¯•å·¥å…·ï¼ˆå¦‚
gdbï¼‰å¯ä»¥åœ¨è¿è¡Œæ—¶æ˜ å°„æœºå™¨ä»£ç å›åˆ°å…¶åŸå§‹çš„æºä»£ç ä½ç½®ã€‚</li>
<li><a
target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2023/pdf/22918222/1698912220821-c1ba5ab6-6c27-41b3-b951-1b0486ecafbe.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2023%2Fpdf%2F22918222%2F1698912220821-c1ba5ab6-6c27-41b3-b951-1b0486ecafbe.pdf%22%2C%22name%22%3A%22ELF_Format.pdf%22%2C%22size%22%3A152347%2C%22ext%22%3A%22pdf%22%2C%22source%22%3A%22%22%2C%22status%22%3A%22done%22%2C%22download%22%3Atrue%2C%22taskId%22%3A%22u19c8bb18-bc03-42de-ae26-29a20f2ad29%22%2C%22taskType%22%3A%22upload%22%2C%22type%22%3A%22application%2Fpdf%22%2C%22__spacing%22%3A%22both%22%2C%22mode%22%3A%22title%22%2C%22id%22%3A%22ue7897fdb%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22file%22%7D">ELF_Format.pdf</a></li>
</ul></li>
</ul></li>
</ul>
<h2 id="linker">Linker</h2>
<ul>
<li>æŠŠå¤šä¸ªæ±‡ç¼–äº§ç”Ÿçš„äºŒè¿›åˆ¶æ–‡ä»¶ç»„åˆåˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶é‡Œ
<ul>
<li>å¤šä¸ªæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼ŸæŸä¸ªéƒ¨åˆ†æ”¹å˜äº†ï¼Œé‚£æˆ‘ä»¬ä¸éœ€è¦é‡æ–°ç¼–è¯‘æ•´ä¸ªå·¥ç¨‹</li>
<li>Link
Editorçš„æ—§åå«Linkï¼Œå› ä¸ºå®ƒè¿‡å»å¤§éƒ¨åˆ†çš„ä»»åŠ¡å°±æ˜¯å¤„ç†è·³è½¬å¸¦æ¥çš„å¼•ç”¨è¢«æ­£ç¡®çš„è§£æä¸ºå†…å­˜åœ°å€ï¼Œä»¥åŠå¡«å……æ‰€æœ‰ç»å¯¹åœ°å€</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002998.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>æœ‰ä¸‰ç§ä¸åŒçš„åœ°å€ï¼ˆAdressï¼‰</li>
</ul>
<ol type="1">
<li><strong>PC-Relative Addressing (beq, bne, jal)</strong></li>
</ol>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šä¸ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ç›¸å…³çš„åœ°å€æ–¹å¼ã€‚è¿™æ„å‘³ç€è·³è½¬çš„ç›®æ ‡åœ°å€æ˜¯åŸºäºå½“å‰æŒ‡ä»¤çš„åœ°å€åŠ ä¸Šæˆ–å‡å»ä¸€ä¸ªåç§»é‡æ¥ç¡®å®šçš„ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¸¸ç”¨äºæ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ï¼Œå¦‚<code>beq</code>ï¼ˆç­‰äºåˆ™è·³è½¬ï¼‰å’Œ<code>bne</code>ï¼ˆä¸ç­‰äºåˆ™è·³è½¬ï¼‰ï¼Œä»¥åŠæ— æ¡ä»¶è·³è½¬<code>jal</code>ã€‚</li>
<li><strong>è¡¥å……</strong>ï¼šè¿™ç§åœ°å€æ–¹å¼ä¸ä¼šé‡æ–°å®šä½ã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬çš„ç›®æ ‡åœ°å€æ˜¯åŠ¨æ€è®¡ç®—çš„ï¼Œä¸éœ€è¦é¢„å…ˆçŸ¥é“ç»å¯¹åœ°å€ã€‚</li>
</ul>
<ol start="2" type="1">
<li><strong>External Function Reference (usually jal)</strong></li>
</ol>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šç”¨äºå¼•ç”¨å¤–éƒ¨å‡½æ•°ã€‚è¿™äº›å‡½æ•°çš„ç¡®åˆ‡åœ°å€ç›´åˆ°é“¾æ¥æ—¶æ‰èƒ½ç¡®å®šã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåœ¨è°ƒç”¨åº“å‡½æ•°æˆ–å…¶ä»–æ¨¡å—ä¸­çš„å‡½æ•°æ—¶ç»å¸¸ä½¿ç”¨ã€‚</li>
<li><strong>è¡¥å……</strong>ï¼šè¿™ç§å¼•ç”¨åœ¨é“¾æ¥æ—¶æ€»æ˜¯éœ€è¦é‡æ–°å®šä½ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æ—¶ä¸çŸ¥é“å‡½æ•°çš„ç¡®åˆ‡åœ°å€ã€‚</li>
</ul>
<ol start="3" type="1">
<li><strong>Static Data Reference (often auipc and addi)</strong></li>
</ol>
<ul>
<li><p><strong>ç‰¹ç‚¹</strong>ï¼šç”¨äºå¼•ç”¨é™æ€æ•°æ®ï¼Œå¦‚å…¨å±€å˜é‡æˆ–å¸¸é‡ã€‚</p></li>
<li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå½“ç¨‹åºéœ€è¦è®¿é—®é™æ€æ•°æ®æ—¶ä½¿ç”¨ã€‚</p></li>
<li><p><strong>è¡¥å……</strong>ï¼šåœ¨RISC-Vä¸­ï¼Œé€šå¸¸ä½¿ç”¨<code>auipc</code>ï¼ˆå°†PCå€¼ä¸ä¸€ä¸ª20ä½çš„ç«‹å³æ•°ç›¸åŠ å¹¶å­˜å‚¨ç»“æœï¼‰å’Œ<code>addi</code>ï¼ˆå°†å¯„å­˜å™¨å€¼ä¸ä¸€ä¸ª12ä½çš„ç«‹å³æ•°ç›¸åŠ ï¼‰æŒ‡ä»¤ç»„åˆæ¥æ„é€ å®Œæ•´çš„32ä½åœ°å€ã€‚ä¸ä½¿ç”¨<code>lui</code>ï¼ˆåŠ è½½ä¸Šä½ç«‹å³æ•°åˆ°å¯„å­˜å™¨ï¼‰ä¸åŒï¼Œä½¿ç”¨<code>auipc</code>å¯ä»¥ç¡®ä¿å¤§å—æ•°æ®å¯ä»¥åœ¨é“¾æ¥æ—¶é‡æ–°å®šä½ï¼Œåªè¦å®ƒç›¸å¯¹äºPCæ˜¯å›ºå®šçš„ã€‚</p></li>
<li><p>è§£å†³é‡å¼•ç”¨é—®é¢˜</p>
<ul>
<li>Linkerå‡è®¾å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¬ä¸€ä¸ª<code>word</code>ä»¥åŠç¬¬ä¸€ä¸ª<code>text</code>æ®µçš„å¯å§‹åœ°å€ä¸º0x10000
(é’ˆå¯¹RISC-Vï¼‰
<ul>
<li>LinkerçŸ¥é“<code>text</code>æ®µä»¥åŠ<code>word</code>é¡ºåºåŠå…¶å„è‡ªçš„å¤§å°</li>
<li>Linkerå¯ä»¥æ ¹æ®è¿™äº›è®¡ç®—å‡ºæ¯ä¸€ä¸ª<code>label</code>ä»¥åŠæ¯ä¸€å—<code>data</code>çš„ç»å¯¹åœ°å€
<ul>
<li>åœ¨ç¬¦å·è¡¨å†…å¯»æ‰¾ç¬¦å·ï¼Œæ‰¾ä¸åˆ°å°±å»<code>library file</code></li>
<li>ç»å¯¹åœ°å€åªè¦è¢«ç¡®å®šï¼Œé‚£ä¹ˆå°±è½¬æ¢ä¸ºæœºå™¨ä»£ç </li>
<li>è¾“å‡ºåŒ…å«<code>text</code>å’Œ<code>data</code>ä»¥åŠ<code>header</code>çš„å¯æ‰§è¡Œæ–‡ä»¶</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h2 id="loader">Loader</h2>
<ul>
<li>æ¥å—å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œ
<ul>
<li>ä»ç¡¬ç›˜ä¸­è¯»å–å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶åè¿è¡Œ</li>
<li>è¿™æ˜¯ç”±æ“ä½œç³»ç»Ÿæä¾›çš„åŠŸèƒ½</li>
</ul></li>
<li>å¤§è‡´æœ‰6æ­¥
<ul>
<li><strong>æ–‡ä»¶è¯»å–</strong>ï¼šåŠ è½½å™¨é¦–å…ˆè¯»å–å¯æ‰§è¡Œæ–‡ä»¶çš„å¤´éƒ¨ï¼Œä»¥ç¡®å®šæ–‡æœ¬å’Œæ•°æ®æ®µçš„å¤§å°ã€‚</li>
<li><strong>åœ°å€ç©ºé—´çš„åˆ›å»º</strong>ï¼šä¸ºåŒ…å«æ–‡æœ¬å’Œæ•°æ®æ®µçš„ç¨‹åºåˆ›å»ºæ–°çš„åœ°å€ç©ºé—´ï¼Œæ­¤ç©ºé—´è¿˜åŒ…å«ä¸€ä¸ªå †æ ˆæ®µã€‚</li>
<li><strong>æŒ‡ä»¤ä¸æ•°æ®çš„å¤åˆ¶</strong>ï¼šå°†æ¥è‡ªå¯æ‰§è¡Œæ–‡ä»¶çš„æŒ‡ä»¤å’Œæ•°æ®å¤åˆ¶åˆ°æ–°åˆ›å»ºçš„åœ°å€ç©ºé—´ä¸­ã€‚</li>
<li><strong>å‚æ•°å¤åˆ¶</strong>ï¼šå°†ä¼ é€’ç»™ç¨‹åºçš„å‚æ•°å¤åˆ¶åˆ°å †æ ˆä¸Šã€‚</li>
<li><strong>æœºå™¨å¯„å­˜å™¨çš„åˆå§‹åŒ–</strong>ï¼š
<ul>
<li>æ¸…é™¤å¤§å¤šæ•°å¯„å­˜å™¨ã€‚</li>
<li>åˆå§‹åŒ–å †æ ˆæŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘å †æ ˆçš„ç¬¬ä¸€ä¸ªå¯ç”¨ä½ç½®ã€‚</li>
</ul></li>
<li><strong>å¯åŠ¨ç¨‹åº</strong>ï¼š
<ul>
<li>è·³è½¬åˆ°å¯åŠ¨ä¾‹ç¨‹ï¼Œè¯¥ä¾‹ç¨‹ä»å †æ ˆå¤åˆ¶ç¨‹åºçš„å‚æ•°åˆ°å¯„å­˜å™¨ï¼Œå¹¶è®¾ç½®ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ã€‚</li>
<li>å¦‚æœä¸»ç¨‹åºè¿”å›ï¼Œå¯åŠ¨ä¾‹ç¨‹å°†ä½¿ç”¨é€€å‡ºç³»ç»Ÿè°ƒç”¨æ¥ç»ˆæ­¢ç¨‹åºã€‚</li>
</ul></li>
</ul></li>
<li>Example</li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002999.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li>Auipcæ¶ˆå¤±äº†
<ul>
<li>å®é™…ä¸Šæ˜¯è¢«ä¼˜åŒ–ä¸ºäº†ç«‹å³æ•°å¯»å€</li>
</ul></li>
</ul>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002000.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h1 id="lecture-10-combinational-logic">Lecture 10 Combinational
Logic</h1>
<p><a
target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2023/pdf/22918222/1698920964742-d9ac9225-2738-4c1d-b9b2-83b6abd9729e.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2023%2Fpdf%2F22918222%2F1698920964742-d9ac9225-2738-4c1d-b9b2-83b6abd9729e.pdf%22%2C%22name%22%3A%22lec10.pdf%22%2C%22size%22%3A8535908%2C%22ext%22%3A%22pdf%22%2C%22source%22%3A%22%22%2C%22status%22%3A%22done%22%2C%22download%22%3Atrue%2C%22taskId%22%3A%22ub71ff804-0638-40a4-b174-0f77b69acaa%22%2C%22taskType%22%3A%22upload%22%2C%22type%22%3A%22application%2Fpdf%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22u7bfa9027%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22file%22%7D">lec10.pdf</a>
# Lab ## Lab 0</p>
<ul>
<li>å¸¸ç”¨çš„Cliå¿«æ·é”®
<ul>
<li><code>ctrl+u</code> åˆ é™¤æ•´è¡Œ</li>
<li><code>ctrl+a</code> ç§»åŠ¨åˆ°è¡Œé¦–</li>
<li><code>ctrl+e</code> ç§»åŠ¨åˆ°è¡Œå°¾</li>
<li><code>ctrl+r</code> æŸ¥è¯¢è¿‘æœŸçš„å‘½ä»¤<br />
</li>
</ul></li>
<li>æ–‡ä»¶æ“ä½œ
<ul>
<li>åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ <code>touch a.txt</code></li>
<li>å†™å…¥ä¸€äº›å†…å®¹ <code>echo "hello world" &gt; a.txt</code></li>
<li>æŸ¥çœ‹æ–‡ä»¶å†…å®¹ <code>cat a.txt</code></li>
<li>æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶å†…å®¹çš„å·®åˆ« <code>diff a b</code></li>
</ul></li>
<li>æŸ¥çœ‹å‘½ä»¤æ‰‹å†Œï¼Œä»¥echoä¸ºä¾‹
<ul>
<li><code>man echo | less</code></li>
</ul></li>
<li>Vim</li>
<li>Git</li>
</ul>
<h2 id="lab-1">Lab 1</h2>
<ul>
<li><p>task1 é€šè¿‡ä¿®æ”¹eccentric.cä¸­çš„å®å¾—åˆ°å¦‚ä¸‹çš„è¾“å‡º <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">Berkeley eccentrics:<br>====================<br>Happy Happy Happy<br>Yoshua<br>Go BEARS!<br></code></pre></td></tr></table></figure>
æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œå°±æ˜¯åˆå¿˜äº†gccå’‹ç¼–è¯‘äº† <img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002001.png" srcset="/img/loading.gif" lazyload
alt="image.png" /></p></li>
<li><p>task2 ç”¨gdb</p></li>
</ul>
<ol type="1">
<li><p>While youâ€™re in a gdb session, how do you <strong>set the
arguments</strong> that will be passed to the program when itâ€™s
run?</p></li>
<li><p>How do you <strong>create a breakpoint</strong>?</p></li>
<li><p>How do you <strong>execute the next line of C code</strong> in
the program after stopping at a breakpoint?</p></li>
<li><p>If the next line of code is a function call, youâ€™ll execute the
whole function call at once if you use your answer to #3. (If not,
consider a different command for #3!) How do you tell GDB that you
<strong>want to debug the code inside the function</strong> (i.e. step
into the function) instead? (If you changed your answer to #3, then that
answer is most likely now applicable here.)</p></li>
<li><p>How do you <strong>continue the program after stopping</strong>
at a breakpoint?</p></li>
<li><p>How can you <strong>print the value of a variable</strong> (or
even an expression like 1+2) in gdb?</p></li>
<li><p>How do you configure gdb so it <strong>displays the value of a
variable after every step</strong>?</p></li>
<li><p>How do you <strong>show a list of all variables and their
values</strong> in the current function?</p></li>
<li><p>How do you <strong>quit</strong> out of gdb?</p></li>
<li><p>use <code>set args arg1 arg2 arg3</code></p></li>
<li><p>use <code>break file.c:2</code></p></li>
<li><p><code>step</code> or <code>next</code>, but for stander fuc like
"printf" ,do not use step but next, cz stander func has no source code,
major of cases they are very low-level</p></li>
<li><p><code>step</code></p></li>
<li><p><code>continue</code></p></li>
<li><p><code>print a+b</code> and a or b respents the real
variables.</p></li>
<li><p>use <code>display a</code>, and <code>undisplay a</code>
cancel.</p></li>
<li><p><code>info locals</code></p></li>
<li><p><code>exit</code></p></li>
</ol>
<ul>
<li><p>task3 é‡å®šå‘</p>
<ul>
<li>./task &lt; input.out</li>
<li>run &lt; input.out &gt; output.out</li>
</ul></li>
<li><p>task4 Valgrind</p></li>
<li><p>task5 å›ç¯é“¾è¡¨ <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">ll_has_cycle</span><span class="hljs-params">(node *head)</span> &#123;<br>    node* fast = head;<br>    node* slow = head;<br>    <span class="hljs-keyword">while</span>(fast!=<span class="hljs-literal">NULL</span>&amp;&amp;fast-&gt;next!=<span class="hljs-literal">NULL</span>)&#123;<br>        fast = fast-&gt;next-&gt;next;<br>        slow = slow-&gt;next;<br>        <span class="hljs-keyword">if</span>(fast == slow)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p></li>
</ul>
<h2 id="lab-2">Lab 2</h2>
<ul>
<li>Makefile è§£é‡Š</li>
</ul>
<ol type="1">
<li><p>Which target is part of a rule that deletes all the compiled
programs?</p></li>
<li><p>Which target is part of a rule that makes all the compiled
programs?</p></li>
<li><p>Which compiler is currently being used?</p></li>
<li><p>What C standard are we currently using?</p></li>
<li><p>How would we reference a variable FOO in a makefile?</p></li>
<li><p>What operating system does the term â€œDarwinâ€ represent?</p></li>
<li><p>What line creates the lfsr program from its object files? (Give
its line number.)</p></li>
<li><p>åˆ é™¤æ‰€æœ‰å·²ç¼–è¯‘ç¨‹åºçš„è§„åˆ™çš„ç›®æ ‡æ˜¯
<code>clean</code>ã€‚å®ƒç”¨äºæ¸…ç†å’Œåˆ é™¤ç”Ÿæˆçš„æ–‡ä»¶ã€‚</p></li>
<li><p>åˆ¶ä½œæ‰€æœ‰å·²ç¼–è¯‘ç¨‹åºçš„è§„åˆ™çš„ç›®æ ‡æ˜¯
<code>all</code>ã€‚è¿™æ˜¯é»˜è®¤ç›®æ ‡ï¼Œè¿è¡Œ <code>make</code>
è€Œä¸æŒ‡å®šç›®æ ‡å°†æ„å»ºæ‰€æœ‰å·²ç¼–è¯‘ç¨‹åºã€‚</p></li>
<li><p>å½“å‰æ­£åœ¨ä½¿ç”¨çš„ç¼–è¯‘å™¨æ˜¯ <code>gcc</code>ï¼Œå¦‚ <code>CC</code>
å˜é‡ä¸­æ‰€æŒ‡å®šçš„ã€‚</p></li>
<li><p>å½“å‰æ­£åœ¨ä½¿ç”¨çš„Cæ ‡å‡†æ˜¯C99ï¼Œå¦‚<code>CFLAGS</code>å˜é‡ä¸­çš„<code>-std=c99</code>æ ‡å¿—æ‰€æŒ‡å®šã€‚</p></li>
<li><p>è¦åœ¨Makefileä¸­å¼•ç”¨å˜é‡ <code>FOO</code>ï¼Œä½¿ç”¨ <code>$(FOO)</code>
è¡¨ç¤ºã€‚</p></li>
</ol>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment"># 1. Variables and conditionals</span><br>UNAME_S := <span class="hljs-variable">$(<span class="hljs-built_in">shell</span> uname -s)</span><br>CC=gcc<br>LD=gcc<br>CFLAGS=-ggdb -Wall -std=c99<br>LDFLAGS=<br><br><span class="hljs-keyword">ifeq</span> (<span class="hljs-variable">$(UNAME_S)</span>, Darwin)<br>    MEMCHECK=valgrind --tool=memcheck --leak-check=full --track-origins=yes --dsymutil=yes --suppressions=osx_vector.supp<br><span class="hljs-keyword">endif</span><br><br><span class="hljs-keyword">ifeq</span> (<span class="hljs-variable">$(UNAME_S)</span>, Linux)<br>    MEMCHECK=valgrind --tool=memcheck --leak-check=full --track-origins=yes<br><span class="hljs-keyword">endif</span><br><br><span class="hljs-comment"># 2. Targets and their object files</span><br>BIT_OPS_OBJS = bit_ops.o test_bit_ops.o<br>BIT_OPS_PROG = bit_ops<br><br>LFSR_OBJS = lfsr.o test_lfsr.o<br>LFSR_PROG = lfsr<br><br>VECTOR_OBJS=vector.o vector_test.o<br>VECTOR_PROG=vector_test<br><br>LIST_OBJS=test_list.o list.o<br>LIST_PROG=list<br><br>BINARIES=<span class="hljs-variable">$(VECTOR_PROG)</span> <span class="hljs-variable">$(BIT_OPS_PROG)</span> <span class="hljs-variable">$(LFSR_PROG)</span> <span class="hljs-variable">$(LIST_PROG)</span><br><br><span class="hljs-comment"># 3. Compilation and linking rules</span><br><span class="hljs-section">all: <span class="hljs-variable">$(BINARIES)</span></span><br><br><span class="hljs-variable">$(BIT_OPS_PROG)</span>: <span class="hljs-variable">$(BIT_OPS_OBJS)</span><br>	<span class="hljs-variable">$(CC)</span> <span class="hljs-variable">$(CFLAGS)</span> -g -o <span class="hljs-variable">$(BIT_OPS_PROG)</span> <span class="hljs-variable">$(BIT_OPS_OBJS)</span> <span class="hljs-variable">$(LDFLAGS)</span><br><br><span class="hljs-variable">$(LFSR_PROG)</span>: <span class="hljs-variable">$(LFSR_OBJS)</span><br>	<span class="hljs-variable">$(CC)</span> <span class="hljs-variable">$(CFLAGS)</span> -g -o <span class="hljs-variable">$(LFSR_PROG)</span> <span class="hljs-variable">$(LFSR_OBJS)</span> <span class="hljs-variable">$(LDFLAGS)</span><br><br><span class="hljs-variable">$(VECTOR_PROG)</span>: <span class="hljs-variable">$(VECTOR_OBJS)</span><br>	<span class="hljs-variable">$(CC)</span> <span class="hljs-variable">$(CFLAGS)</span> -g -o <span class="hljs-variable">$(VECTOR_PROG)</span> <span class="hljs-variable">$(VECTOR_OBJS)</span> <span class="hljs-variable">$(LDFLAGS)</span><br><br><span class="hljs-variable">$(LIST_PROG)</span>: <span class="hljs-variable">$(LIST_OBJS)</span><br>	<span class="hljs-variable">$(CC)</span> <span class="hljs-variable">$(CFLAGS)</span> -g -o <span class="hljs-variable">$(LIST_PROG)</span> <span class="hljs-variable">$(LIST_OBJS)</span> <span class="hljs-variable">$(LDFLAGS)</span><br><br><span class="hljs-section">.c.o:</span><br>	<span class="hljs-variable">$(CC)</span> -c <span class="hljs-variable">$(CFLAGS)</span> <span class="hljs-variable">$&lt;</span><br><br><span class="hljs-section">vector-memcheck: <span class="hljs-variable">$(VECTOR_PROG)</span></span><br>	<span class="hljs-variable">$(MEMCHECK)</span> ./<span class="hljs-variable">$(VECTOR_PROG)</span><br><br><span class="hljs-comment"># 4. Header dependencies</span><br><span class="hljs-section">lfsr.c: lfsr.h</span><br><span class="hljs-section">test_lfsr.c: lfsr.h</span><br><br><span class="hljs-section">bit_ops.c: bit_ops.h</span><br><span class="hljs-section">test_bit_ops.c: bit_ops.h</span><br><br><span class="hljs-section">vector.c: vector.h</span><br><span class="hljs-section">vector_test.c: vector.h</span><br><br><span class="hljs-section">list.c: list.h</span><br><span class="hljs-section">list_test.c: list.h</span><br><br><span class="hljs-comment"># 5. Other commands</span><br><span class="hljs-section">clean:</span><br>	-rm -rf core *.o *~ <span class="hljs-string">&quot;#&quot;</span>*<span class="hljs-string">&quot;#&quot;</span> Makefile.bak <span class="hljs-variable">$(BINARIES)</span> *.dSYM<br><br></code></pre></td></tr></table></figure>
<ol type="1">
<li><code>UNAME_S := $(shell uname -s)</code>ï¼šè¿™ä¸€è¡Œä½¿ç”¨<code>uname -s</code>å‘½ä»¤æ¥è·å–å½“å‰æ“ä½œç³»ç»Ÿçš„åç§°ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨<code>UNAME_S</code>å˜é‡ä¸­ã€‚</li>
<li>å®šä¹‰ä¸€äº›ç¼–è¯‘å™¨å’Œç¼–è¯‘é€‰é¡¹çš„å˜é‡ï¼š</li>
</ol>
<ul>
<li><code>CC</code>ï¼šCç¼–è¯‘å™¨ï¼Œè®¾ç½®ä¸º<code>gcc</code>ã€‚</li>
<li><code>LD</code>ï¼šé“¾æ¥å™¨ï¼Œä¹Ÿè®¾ç½®ä¸º<code>gcc</code>ã€‚</li>
<li><code>CFLAGS</code>ï¼šç¼–è¯‘å™¨é€‰é¡¹ï¼ŒåŒ…æ‹¬<code>-ggdb</code>ï¼ˆç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼‰ã€<code>-Wall</code>ï¼ˆæ˜¾ç¤ºè­¦å‘Šï¼‰ã€<code>-std=c99</code>ï¼ˆä½¿ç”¨C99æ ‡å‡†ï¼‰ç­‰ã€‚</li>
<li><code>LDFLAGS</code>ï¼šé“¾æ¥å™¨é€‰é¡¹ï¼Œç›®å‰ä¸ºç©ºï¼Œå¯ä»¥ç”¨äºæ·»åŠ é“¾æ¥é€‰é¡¹ã€‚</li>
</ul>
<ol start="3" type="1">
<li>æ ¹æ®æ“ä½œç³»ç»Ÿè®¾ç½®<code>MEMCHECK</code>å˜é‡ï¼Œç”¨äºåœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šè¿è¡Œå†…å­˜æ£€æŸ¥å·¥å…·ï¼ˆValgrindï¼‰æ—¶ä½¿ç”¨ä¸åŒçš„é€‰é¡¹ã€‚åœ¨Darwinï¼ˆmacOSï¼‰ä¸Šï¼Œè®¾ç½®äº†ä¸€ç»„é€‰é¡¹ï¼Œè€Œåœ¨Linuxä¸Šè®¾ç½®äº†å¦ä¸€ç»„é€‰é¡¹ã€‚</li>
<li>å®šä¹‰äº†ä¸‰ä¸ªç›®æ ‡çš„ç›¸å…³å˜é‡ï¼š</li>
</ol>
<ul>
<li><code>BIT_OPS_OBJS</code>ï¼šç”¨äºå­˜å‚¨ä¸ä½æ“ä½œç›¸å…³çš„ç›®æ ‡æ–‡ä»¶çš„åç§°ã€‚</li>
<li><code>LFSR_OBJS</code>ï¼šç”¨äºå­˜å‚¨ä¸çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ç›¸å…³çš„ç›®æ ‡æ–‡ä»¶çš„åç§°ã€‚</li>
<li><code>VECTOR_OBJS</code>ï¼šç”¨äºå­˜å‚¨ä¸å‘é‡æ“ä½œç›¸å…³çš„ç›®æ ‡æ–‡ä»¶çš„åç§°ã€‚</li>
</ul>
<ol start="5" type="1">
<li>å®šä¹‰äº†ä¸‰ä¸ªå¯æ‰§è¡Œç¨‹åºçš„åç§°ï¼š</li>
</ol>
<ul>
<li><code>BIT_OPS_PROG</code>ï¼šä½æ“ä½œç›¸å…³çš„å¯æ‰§è¡Œç¨‹åºåç§°ã€‚</li>
<li><code>LFSR_PROG</code>ï¼šçº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ç›¸å…³çš„å¯æ‰§è¡Œç¨‹åºåç§°ã€‚</li>
<li><code>VECTOR_PROG</code>ï¼šå‘é‡æ“ä½œç›¸å…³çš„å¯æ‰§è¡Œç¨‹åºåç§°ã€‚</li>
</ul>
<ol start="6" type="1">
<li>å®šä¹‰äº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯æ‰§è¡Œç¨‹åºåç§°çš„å˜é‡<code>BINARIES</code>ã€‚</li>
<li><code>all: $(BINARIES)</code>ï¼šè¿™æ˜¯é»˜è®¤ç›®æ ‡ï¼Œè¡¨ç¤ºè¿è¡Œ<code>make</code>å‘½ä»¤æ—¶å°†æ„å»ºæ‰€æœ‰çš„å¯æ‰§è¡Œç¨‹åºã€‚</li>
<li>ä¸‹é¢æ˜¯å„ä¸ªå¯æ‰§è¡Œç¨‹åºçš„æ„å»ºè§„åˆ™ã€‚æ¯ä¸ªè§„åˆ™æŒ‡å®šäº†å¯æ‰§è¡Œç¨‹åºçš„ä¾èµ–é¡¹ï¼ˆç›®æ ‡æ–‡ä»¶ï¼‰å’Œå¦‚ä½•æ„å»ºå®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œ<code>$(BIT_OPS_PROG)</code>çš„æ„å»ºè§„åˆ™åŒ…æ‹¬å°†<code>$(BIT_OPS_OBJS)</code>é“¾æ¥åˆ°ä¸€èµ·ï¼Œç„¶åä½¿ç”¨æŒ‡å®šçš„ç¼–è¯‘å™¨å’Œé€‰é¡¹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>ä¸‹é¢çš„è§„åˆ™ç”¨äºç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆ.oæ–‡ä»¶ï¼‰ï¼š<code>.c.o:</code>ã€‚å®ƒå‘Šè¯‰Makeå¦‚ä½•å°†Cæºæ–‡ä»¶ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶ã€‚å®ƒä½¿ç”¨äº†<code>$(CC)</code>å’Œ<code>$(CFLAGS)</code>å˜é‡æ¥æ‰§è¡Œç¼–è¯‘ã€‚</li>
<li><code>vector-memcheck: $(VECTOR_PROG)</code>ï¼šè¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®æ ‡ï¼Œç”¨äºè¿è¡ŒValgrindå†…å­˜æ£€æŸ¥å·¥å…·æ¥æµ‹è¯•<code>$(VECTOR_PROG)</code>ç¨‹åºã€‚</li>
<li><code>clean:</code>ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºæ¸…ç†é¡¹ç›®çš„ç›®æ ‡ã€‚å®ƒåˆ é™¤ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€ç›®æ ‡æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ç­‰ã€‚<code>-rm</code>è¡¨ç¤ºå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ä¹Ÿä¸ä¼šç”Ÿæˆé”™è¯¯æ¶ˆæ¯ï¼Œå› æ­¤å¯ä»¥å®‰å…¨åœ°åˆ é™¤æ–‡ä»¶ã€‚</li>
<li>æœ€åï¼Œæœ‰ä¸€äº›ä¾èµ–å…³ç³»è§„åˆ™ï¼Œç”¨äºç¡®ä¿æºæ–‡ä»¶ï¼ˆ.cæ–‡ä»¶ï¼‰ä¸ç›¸å…³çš„å¤´æ–‡ä»¶ï¼ˆ.hæ–‡ä»¶ï¼‰ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚</li>
</ol>
<p>é€šè¿‡åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ<code>make</code>å¹¶é€‰æ‹©ç›®æ ‡ï¼Œå¯ä»¥æ„å»ºå¯æ‰§è¡Œç¨‹åºï¼Œè¿è¡Œå†…å­˜æ£€æŸ¥ï¼Œæˆ–è€…æ‰§è¡Œæ¸…ç†æ“ä½œï¼Œå…·ä½“å–å†³äºéœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œè¦æ„å»ºæ‰€æœ‰çš„å¯æ‰§è¡Œç¨‹åºï¼Œåªéœ€è¿è¡Œ<code>make</code>ã€‚è¦è¿è¡Œ<code>vector_test</code>çš„å†…å­˜æ£€æŸ¥ï¼Œå¯ä»¥è¿è¡Œ<code>make vector-memcheck</code>ã€‚è¦æ¸…ç†é¡¹ç›®ï¼Œå¯ä»¥è¿è¡Œ<code>make clean</code>ã€‚</p>
<ul>
<li>Bit operations
<ul>
<li>åªèƒ½ç”¨&amp;ï¼Œ^ï¼Œä»¥åŠ ï½œ</li>
<li>ä¸èƒ½å¾ªç¯ï¼Œä¸èƒ½é™¤æ³•ï¼Œä¸èƒ½å–æ¨¡ <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;bit_ops.h&quot;</span></span><br><br><span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> mp[<span class="hljs-number">32</span>] = &#123;<br>    <span class="hljs-number">0x80000000</span>,<br>    <span class="hljs-number">0x40000000</span>,<br>    <span class="hljs-number">0x20000000</span>,<br>    <span class="hljs-number">0x10000000</span>,<br>    <span class="hljs-number">0x08000000</span>,<br>    <span class="hljs-number">0x04000000</span>,<br>    <span class="hljs-number">0x02000000</span>,<br>    <span class="hljs-number">0x01000000</span>,<br>    <span class="hljs-number">0x00800000</span>,<br>    <span class="hljs-number">0x00400000</span>,<br>    <span class="hljs-number">0x00200000</span>,<br>    <span class="hljs-number">0x00100000</span>,<br>    <span class="hljs-number">0x00080000</span>,<br>    <span class="hljs-number">0x00040000</span>,<br>    <span class="hljs-number">0x00020000</span>,<br>    <span class="hljs-number">0x00010000</span>,<br>    <span class="hljs-number">0x00008000</span>,<br>    <span class="hljs-number">0x00004000</span>,<br>    <span class="hljs-number">0x00002000</span>,<br>    <span class="hljs-number">0x00001000</span>,<br>    <span class="hljs-number">0x00000800</span>,<br>    <span class="hljs-number">0x00000400</span>,<br>    <span class="hljs-number">0x00000200</span>,<br>    <span class="hljs-number">0x00000100</span>,<br>    <span class="hljs-number">0x00000080</span>,<br>    <span class="hljs-number">0x00000040</span>,<br>    <span class="hljs-number">0x00000020</span>,<br>    <span class="hljs-number">0x00000010</span>,<br>    <span class="hljs-number">0x00000008</span>,<br>    <span class="hljs-number">0x00000004</span>,<br>    <span class="hljs-number">0x00000002</span>,<br>    <span class="hljs-number">0x00000001</span><br>    &#125;;<br><br><span class="hljs-comment">// Return the nth bit of x.</span><br><span class="hljs-comment">// Assume 0 &lt;= n &lt;= 31</span><br><span class="hljs-type">unsigned</span> <span class="hljs-title function_">get_bit</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> x,<span class="hljs-type">unsigned</span> n)</span>&#123;<br>    n = <span class="hljs-number">31</span> - n;<br><br>    <span class="hljs-keyword">if</span>((x &amp; mp[n])!=<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">// Set the nth bit of the value of x to v.</span><br><span class="hljs-comment">// Assume 0 &lt;= n &lt;= 31, and v is 0 or 1</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">set_bit</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> * x,</span><br><span class="hljs-params">             <span class="hljs-type">unsigned</span> n,</span><br><span class="hljs-params">             <span class="hljs-type">unsigned</span> v)</span> &#123;<br>    n = <span class="hljs-number">31</span> - n;<br>    <span class="hljs-type">unsigned</span> mpn = mp[n];<br>    <span class="hljs-keyword">if</span>(v == <span class="hljs-number">0</span>)&#123;<br>        mpn = mpn ^ <span class="hljs-number">0xFFFFFFFF</span>;<br>        *x = *x &amp; mpn;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(v == <span class="hljs-number">1</span>)<br>        *x = *x | mpn;<br>    <span class="hljs-keyword">return</span> ;<br>&#125;<br><span class="hljs-comment">// Flip the nth bit of the value of x.</span><br><span class="hljs-comment">// Assume 0 &lt;= n &lt;= 31</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">flip_bit</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> * x,</span><br><span class="hljs-params">              <span class="hljs-type">unsigned</span> n)</span> &#123;<br>    <span class="hljs-type">unsigned</span> flipped_value = get_bit(*x, n) ^ <span class="hljs-number">1</span>;<br>    set_bit(x, n, flipped_value);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure></li>
</ul></li>
<li>LSFR
çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨çº¿æ€§åé¦ˆç§»ä½å¯„å­˜å™¨ï¼ˆLFSRï¼‰æ˜¯æ•°å­—ç³»ç»Ÿä¸­çš„ä¸€ç§å¸¸è§ç»“æ„ï¼Œå®ƒå…·æœ‰å¤šç§åº”ç”¨ï¼š</li>
</ul>
<ol type="1">
<li><strong>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ (PRNG)</strong>ï¼šLFSR
æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ–¹å¼æ¥ç”Ÿæˆä¼ªéšæœºæ•°åºåˆ—ã€‚ç”±äºå…¶å›ºå®šçš„ç»“æ„å’Œç‰¹æ€§ï¼Œå®ƒå¯ä»¥åœ¨ç¡¬ä»¶ä¸­éå¸¸é«˜æ•ˆåœ°å®ç°ï¼Œè€Œä¸éœ€è¦å¤§é‡çš„å­˜å‚¨ç©ºé—´æˆ–å¤æ‚çš„ç®—æ³•ã€‚</li>
<li><strong>æµ‹è¯•æ¨¡å¼ç”Ÿæˆ</strong>ï¼šåœ¨ç¡¬ä»¶æµ‹è¯•ä¸­ï¼ŒLFSR
å¸¸ç”¨äºç”Ÿæˆæµ‹è¯•æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨å†…å­˜å’Œé€»è¾‘ç”µè·¯çš„å†…å»ºè‡ªæµ‹ (BIST, Built-In
Self-Test) ä¸­ã€‚</li>
<li><strong>æ•°æ®åŠ å¯†å’Œè§£å¯†</strong>ï¼šç”±äºå…¶ä¼ªéšæœºæ€§ï¼ŒLFSR
å¯ä»¥ç”¨äºæµå¯†ç ä¸­çš„å¯†é’¥æµç”Ÿæˆã€‚å®ƒä»¬ç”Ÿæˆçš„ä½æµå¯ä»¥ä¸æ•°æ®æµè¿›è¡Œå¼‚æˆ–æ“ä½œæ¥åŠ å¯†æˆ–è§£å¯†ä¿¡æ¯ã€‚</li>
<li><strong>è¯¯å·®æ£€æµ‹å’Œçº æ­£</strong>ï¼šLFSR å¯ç”¨äºç”Ÿæˆå’Œæ£€æµ‹å¤šé¡¹å¼ç¼–ç ï¼Œå¦‚
CRC (å¾ªç¯å†—ä½™æ£€æŸ¥)ã€‚è¿™äº›ç¼–ç ç”¨äºæ£€æµ‹æ•°æ®ä¼ è¾“ä¸­çš„é”™è¯¯ã€‚</li>
<li><strong>æ•°å­—é€šä¿¡</strong>ï¼šLFSR
ç”¨äºæ‰©é¢‘é€šä¿¡æŠ€æœ¯ï¼Œä¾‹å¦‚ç›´æ¥åºåˆ—æ‰©é¢‘ã€‚</li>
<li><strong>ä¿¡å·æ‰©å±•</strong>ï¼šåœ¨æŸäº›åº”ç”¨ä¸­ï¼ŒLFSR
å¯ç”¨äºå°†è¾ƒçŸ­çš„ä¿¡å·åºåˆ—æ‰©å±•ä¸ºæ›´é•¿çš„åºåˆ—ã€‚</li>
</ol>
<figure>
<img
src="https://raw.githubusercontent.com/ShuaiZhang1998/figure/main/figure/202311030002002.png" srcset="/img/loading.gif" lazyload
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">lfsr_calculate</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> *reg)</span> &#123;<br>    <span class="hljs-type">short</span> loc[] = &#123;<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-type">uint16_t</span> fill = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">4</span>; i++)&#123;<br>        fill ^= (*reg &gt;&gt; loc[i]) &amp; <span class="hljs-number">1</span>;<br>    &#125;<br>    *reg = *reg &gt;&gt; <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span>(fill == <span class="hljs-number">1</span>)&#123;<br>        *reg = *reg | (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">15</span>);<br>    &#125;<br>    <span class="hljs-comment">// ä¸éœ€è¦å¡«å……0ï¼Œå› ä¸ºå‘å³ç§»ä½æ“ä½œå·²ç»ä¸ºæœ€å·¦è¾¹çš„ä½è®¾ç½®äº†0</span><br>    <span class="hljs-keyword">return</span> ;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<ul>
<li>LinkList
<ul>
<li>å¤ªç†Ÿæ‚‰äº†ç›´æ¥æ”¾ä»£ç </li>
<li>æƒ³ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼ æŒ‡é’ˆæ—¶æ˜¯<code>**p</code>è€Œä¸æ˜¯<code>*p</code>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/* Add a node to the end of the linked list. Assume head_ptr is non-null. */</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">append_node</span><span class="hljs-params">(node** head_ptr, <span class="hljs-type">int</span> new_data)</span> </span>&#123;<br>    node *new_node = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(node));  <span class="hljs-comment">// æ›´æ”¹å˜é‡åä¸ºnew_node</span><br>    <span class="hljs-keyword">if</span> (new_node == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-comment">// å¤„ç†å†…å­˜åˆ†é…å¤±è´¥çš„æƒ…å†µï¼Œä¾‹å¦‚è¿”å›æˆ–é€€å‡º</span><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    new_node-&gt;val = new_data;<br>    new_node-&gt;next = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-keyword">if</span> (*head_ptr == <span class="hljs-literal">NULL</span>) &#123;<br>        *head_ptr = new_node;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    node* curr = *head_ptr;<br>    <span class="hljs-keyword">while</span> (curr-&gt;next != <span class="hljs-literal">NULL</span>) &#123;<br>        curr = curr-&gt;next;<br>    &#125;<br>    curr-&gt;next = new_node;  <span class="hljs-comment">// è¿æ¥æ–°èŠ‚ç‚¹åˆ°é“¾è¡¨çš„å°¾éƒ¨</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/* Reverse a linked list in place (in other words, without creating a new list).</span><br><span class="hljs-comment">   Assume that head_ptr is non-null. */</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">reverse_list</span> <span class="hljs-params">(node** head_ptr)</span> </span>&#123;<br>        node* prev = <span class="hljs-literal">NULL</span>;<br>        node* curr = *head_ptr;<br>        node* next = <span class="hljs-literal">NULL</span>;<br>        <span class="hljs-keyword">if</span>(curr==<span class="hljs-literal">NULL</span> || curr-&gt;next == <span class="hljs-literal">NULL</span>)<br>          <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">while</span> (curr != <span class="hljs-literal">NULL</span>) &#123;<br>                next = curr-&gt;next;<br>                curr-&gt;next = prev;<br>                prev = curr;<br>                curr = next;<br>        &#125;<br>        <span class="hljs-comment">/* Set the new head to be what originally was the last node in the list */</span><br>        *head_ptr = prev;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<ul>
<li>vector <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> CS61C_VECTOR_H_</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> CS61C_VECTOR_H_</span><br><span class="hljs-comment">/* vector.h originally written by Jeremy Huddleston &lt;jeremyhu@eecs.berkeley.edu&gt; Sp2004</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * So it looks like you&#x27;ve decided to venture into the &quot;other&quot; files of this</span><br><span class="hljs-comment"> * lab.  Good.  C Header files (the .h extension) are a way of telling other .c</span><br><span class="hljs-comment"> * files what they can have access to.  You usually include stdlib.h in your</span><br><span class="hljs-comment"> * C programs, and this process is identical to including this .h file with the</span><br><span class="hljs-comment"> * one change being:</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * #include &quot;file.h&quot;</span><br><span class="hljs-comment"> * versus</span><br><span class="hljs-comment"> * #include &lt;file.h&gt;</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * The difference is that the &lt;&gt; notation is for system header files and the &quot;&quot;</span><br><span class="hljs-comment"> * is for ones you provide yourself (in your local directory for instance).</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * The header file starts off with</span><br><span class="hljs-comment"> * #ifndef CS61C_VECTOR_H_</span><br><span class="hljs-comment"> * #define CS61C_VECTOR_H_</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * and ends with a final #endif.  This prevents the file from being included</span><br><span class="hljs-comment"> * more than once which could&#x27;ve possibly resulted in an infinite loop of</span><br><span class="hljs-comment"> * file inclusions.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * First, we define the &#x27;vector_t&#x27; datatype.  This next line says that a &#x27;vector_t&#x27;</span><br><span class="hljs-comment"> * is the same as a &#x27;struct vector_t&#x27;.  So anywhere in the code after this, we</span><br><span class="hljs-comment"> * can use &#x27;vector_t *&#x27; to mean a pointer to a &#x27;struct vector_t&#x27; (which is defined in</span><br><span class="hljs-comment"> * vector.c).  We can get away with doing this even though we don&#x27;t know what a</span><br><span class="hljs-comment"> * struct vector is because all struct pointers have the same representation in memory.</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">vector_t</span> <span class="hljs-title">vector_t</span>;</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> *  Next, we provide the prototypes for the functions defined in vector.c.  This</span><br><span class="hljs-comment"> *  is a way of telling the .c files that #include this header what they will</span><br><span class="hljs-comment"> *  have access to.</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">/* Create a new vector */</span><br><span class="hljs-type">vector_t</span> *<span class="hljs-title function_">vector_new</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">/* Free up the memory allocated for the passed vector */</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">vector_delete</span><span class="hljs-params">(<span class="hljs-type">vector_t</span> *v)</span>;<br><br><span class="hljs-comment">/* Return the value in the vector */</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">vector_get</span><span class="hljs-params">(<span class="hljs-type">vector_t</span> *v, <span class="hljs-type">size_t</span> loc)</span>;<br><br><span class="hljs-comment">/* Set a value in the vector */</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">vector_set</span><span class="hljs-params">(<span class="hljs-type">vector_t</span> *v, <span class="hljs-type">size_t</span> loc, <span class="hljs-type">int</span> value)</span>;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br></code></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/* Include the system headers we need */</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-comment">/* Include our header */</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;vector.h&quot;</span></span><br><br><span class="hljs-comment">/* Define what our struct is */</span><br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">vector_t</span> &#123;<br>    <span class="hljs-type">size_t</span> size;<br>    <span class="hljs-type">int</span> *data;<br>&#125;;<br><br><span class="hljs-comment">/* Utility function to handle allocation failures. In this</span><br><span class="hljs-comment">   case we print a message and exit. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">allocation_failed</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">fprintf</span>(stderr, <span class="hljs-string">&quot;Out of memory.\n&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">/* Bad example of how to create a new vector */</span><br><span class="hljs-function"><span class="hljs-type">vector_t</span> *<span class="hljs-title">bad_vector_new</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">//è¿™æ®µä»£ç åœ¨æ ˆä¸Šåˆ›å»ºäº†ä¸€ä¸ªvectorï¼Œè€Œè¿”å›çš„å†…å­˜åœ°å€ä¼šåœ¨å‡½æ•°æ‰§è¡Œå®Œåé”€æ¯</span><br>    <span class="hljs-comment">/* Create the vector and a pointer to it */</span><br>    <span class="hljs-type">vector_t</span> *retval, v;<br>    retval = &amp;v;<br><br>    <span class="hljs-comment">/* Initialize attributes */</span><br>    retval-&gt;size = <span class="hljs-number">1</span>;<br>    retval-&gt;data = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>));<br>    <span class="hljs-keyword">if</span> (retval-&gt;data == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">allocation_failed</span>();<br>    &#125;<br><br>    retval-&gt;data[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">return</span> retval;<br>&#125;<br><br><span class="hljs-comment">/* Another suboptimal way of creating a vector */</span><br><span class="hljs-comment">// åŒæ ·çš„ï¼Œåœ¨æ ˆä¸Šåˆ›å»ºäº†ä¸€ä¸ªvector</span><br><span class="hljs-function"><span class="hljs-type">vector_t</span> <span class="hljs-title">also_bad_vector_new</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">/* Create the vector */</span><br>    <span class="hljs-type">vector_t</span> v;<br><br>    <span class="hljs-comment">/* Initialize attributes */</span><br>    v.size = <span class="hljs-number">1</span>;<br>    v.data = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>));<br>    <span class="hljs-keyword">if</span> (v.data == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">allocation_failed</span>();<br>    &#125;<br>    v.data[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">return</span> v;<br>&#125;<br><br><span class="hljs-comment">/* Create a new vector with a size (length) of 1</span><br><span class="hljs-comment">   and set its single component to zero... the</span><br><span class="hljs-comment">   RIGHT WAY */</span><br><span class="hljs-function"><span class="hljs-type">vector_t</span> *<span class="hljs-title">vector_new</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">/* Declare what this function will return */</span><br>    <span class="hljs-type">vector_t</span> *retval;<br><br>    <span class="hljs-comment">/* First, we need to allocate memory on the heap for the struct */</span><br>    retval = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">vector_t</span>));<br><br>    <span class="hljs-comment">/* Check our return value to make sure we got memory */</span><br>    <span class="hljs-keyword">if</span> (retval == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">allocation_failed</span>();<br>    &#125;<br><br>    <span class="hljs-comment">/* Now we need to initialize our data.</span><br><span class="hljs-comment">       Since retval-&gt;data should be able to dynamically grow,</span><br><span class="hljs-comment">       what do you need to do? */</span><br>    retval-&gt;size = <span class="hljs-number">1</span>;<br>    retval-&gt;data = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>));<br><br>    <span class="hljs-comment">/* Check the data attribute of our vector to make sure we got memory */</span><br>    <span class="hljs-keyword">if</span> (retval-&gt;data == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">free</span>(retval);				<span class="hljs-comment">//Why is this line necessary?</span><br>        <span class="hljs-built_in">allocation_failed</span>();<br>    &#125;<br><br>    <span class="hljs-comment">/* Complete the initialization by setting the single component to zero */</span><br>    retval-&gt;data[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">/* and return... */</span><br>    <span class="hljs-keyword">return</span> retval;<br>&#125;<br><br><span class="hljs-comment">/* Return the value at the specified location/component &quot;loc&quot; of the vector */</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">vector_get</span><span class="hljs-params">(<span class="hljs-type">vector_t</span> *v, <span class="hljs-type">size_t</span> loc)</span> </span>&#123;<br><br>    <span class="hljs-comment">/* If we are passed a NULL pointer for our vector, complain about it and exit. */</span><br>    <span class="hljs-keyword">if</span>(v == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">fprintf</span>(stderr, <span class="hljs-string">&quot;vector_get: passed a NULL vector.\n&quot;</span>);<br>        <span class="hljs-built_in">abort</span>();<br>    &#125;<br><br>    <span class="hljs-comment">/* If the requested location is higher than we have allocated, return 0.</span><br><span class="hljs-comment">     * Otherwise, return what is in the passed location.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">if</span> (loc &lt; v-&gt;size) &#123;<br>	<span class="hljs-keyword">return</span> v-&gt;data[loc];<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* Free up the memory allocated for the passed vector.</span><br><span class="hljs-comment">   Remember, you need to free up ALL the memory that was allocated. */</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">vector_delete</span><span class="hljs-params">(<span class="hljs-type">vector_t</span> *v)</span> </span>&#123;<br>    <span class="hljs-built_in">free</span>(v-&gt;data);<br>    <span class="hljs-built_in">free</span>(v);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-comment">/* Set a value in the vector. If the extra memory allocation fails, call</span><br><span class="hljs-comment">   allocation_failed(). */</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">vector_set</span><span class="hljs-params">(<span class="hljs-type">vector_t</span> *v, <span class="hljs-type">size_t</span> loc, <span class="hljs-type">int</span> value)</span> </span>&#123;<br>    <span class="hljs-comment">/* What do you need to do if the location is greater than the size we have</span><br><span class="hljs-comment">     * allocated?  Remember that unset locations should contain a value of 0.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">if</span>(loc &lt; v-&gt;size) &#123;<br>        v-&gt;data[loc] = value;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">int</span> *new_data = <span class="hljs-built_in">realloc</span>(v-&gt;data, (loc + <span class="hljs-number">1</span>) * <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>));<br>        <span class="hljs-keyword">if</span>(!new_data) &#123;<br>            <span class="hljs-built_in">allocation_failed</span>();<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i = v-&gt;size; i &lt;= loc; i++) &#123;<br>            new_data[i] = <span class="hljs-number">0</span>;<br>        &#125;<br>        v-&gt;data = new_data;<br>        v-&gt;size = loc + <span class="hljs-number">1</span>;<br>        v-&gt;data[loc] = value;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h2 id="lab3">Lab3</h2>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%AC%94%E8%AE%B0/">#ç¬”è®°</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>cs16c</div>
      <div>http://shuaizhang1998.github.io/2023/11/03/CS61C/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Zs</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´11æœˆ3æ—¥</div>
        </div>
      
      
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/30/Introductory%20C%20Programming%20Specialization/" title="c/c++">
                        <span class="hidden-mobile">c/c++</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
